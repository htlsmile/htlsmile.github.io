<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>何去何从</title>
    <url>/2020/04/30/%E4%BD%95%E5%8E%BB%E4%BD%95%E4%BB%8E/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="密码错误，请重试。" data-whm="纳尼，算了，解密吧。"><div class="hbe-input-container"><input type="password" id="hbePass" placeholder="请输入密码：" /><label>请输入密码：</label><div class="bottom-line"></div></div><script id="hbeData" type="hbeData" data-hmacdigest="75475e5f9b972111d9b254870ba0e27edd9f703f3f45499698948b400b3c6446">06ec45df63e3bf3ba50727f74e2e465b1c7e10ef4588988ef2556fd2905ec7c0a61cfa012ffdf7723a08cdd84db70fbe9f362de4096b73d2b11884c280e807a100b0e474456c54cf018c6fc9f33be8bedf9a8ea643f81802b7eacd61cbb38866c2cd61de64f43e9b49e1955fa4502ab164ac6e44caaa4a61cc6a6b05b6836fa5dd686b07a667aa26874e40d0d7cd86d1f8883c77f653284fff2ab0a40789bb3a5568c9b820264cc4bc8d49cb435d42f33a5206ddade244de8dde69e890e118e26e4191134568425f138c5a39b9a46ede630d3a852744b62b3f39d6eccd599b5e59614412abcad6497d29ccb0fc9463b45844ad42c3bc4774c838063ad58d5b60ae87835ab928fa11bf313c00bf0884ce1f1b29984ea65c37e7d3eaf4717f335ce885ae077d101ca3ed0abf194d69eb6586b2e182dc023d08209f897bea889b5877e77c3ba83edf6cde35f373d3a5788127b3b200f2202bef4b79ec42ae4839596771e4def2ccba5f49981dd3b5936987bdcf27003666a019874a6e5682ad5d861ee41acbeffeae954862bf3a5e3cc619fc4a54181d1104a0606ae63160d3809852c6fddfb2640f96863f7e37e3b262ddfda83c31e1ba51bd5036c2194aed01a6d369c634e8a13c1ff4d2326443696016874a3a048b2a6cabd0e41440e5b334f00372ba5d725ebf6da1d365c7098e54f7c0dadd0c6f4aaf69431e4164abcf8854e8b0f3b3532251f687d343733ccfecf526d3c3471c0da0d6d1f7454015eec11a04100aebcf26feb78041d7d048aa8e8420aa8dc0929b75bf78d0ef8deb1ed1af278fc53027155c16ba1576defbc988ceb38eb98049ad81d51cb6c4d6487eb03f7d03d609020fdb9f4310bfba1d98d612cec5bf25c601284cffc86478a723df4411e8fdcd4e7c9832866f8138917ebee88cfd87fb13daf9576d58da5ce9eb71b0ee67ac737dfd826271379a2b3f75e60f02db7d0b2b47439107e2528b86dee57422a0fee57642aa1cbf79903699775f7c39526f8ab63c4c955c97148bd3e9499a345307096c6624ce3a5c7ba09d2502e0bb7d9df1f6561eaf02e70e65cb8d3484b9e6a05f0bd6652299785e7ffd883442548167515bdd560db6e0a466ba95dd482327b18dd286f0f7198d1b5efe9dacf72268cd665d418db5be6cad8d5b3c1114678d58634d043b523f4486ce6bab7b0da5c38d484b63f57194ad9f551953f223d33e9675fe3be14422a25109290b4edc61e5f28ad59882f8a9d1a0935815b36555f81b9ba7b01b246193fd9ec0dbb31947168b01473f17921b400265ea1a46e5276eaf0ed28a7356373a0a005f336793f077a4ae2f53aadacd578dc709d60b96b504996dd8c296fd896b7859c2062df7e1847fe5d7b48dddab35b1a476347539ef0e4f0e4a04bc57b951345cec130240d3c6e9782785797a03080b90be15a4478c3f66b7e07601454c0f1891bfb51d775e583bbb8af16a532d7dbedd26ff8e88a8ddf2181987a856847504ad9df83de5b5331440e4aae80b9fa73c306145bbf3ea7d8154d10b6cfa4d8f5b74264ba047d26eb22099cffe2bb882feafa2a74e58280cf7494eaa6c5fbb8e95e7cfe4627c3f241aa005fdb80af8a8099d82d5a87cd11793f17ac39eff3e15ce7dfddca54116ad1ef95024241d57c403018ec6af6a04b316aad9fbdd738b78cef21330d23ebe9603caf8109197c513c2abf5d5947cde939768feffd7a141f854aa3a5c3a1b32f06c801d7f1b13b252e28c05952557ab143ced9016818367112e51fa6950f98ecc09fb2c8d698c7598035cbdf627f3365f5b16d3eb501a07070b8f2922993ab0e3abfe876e4067ca27fc9c00528183e1f279437297303f827c163f9a33a1e38d0ffe22454cfaaa737816ccd4dec9d88dac856f285604ac6fa4489c23116affc3c278e59d5dc39c9cc9e24415f287f1f0b2cd0c58e947a9571fa2506a942fd333398c046c11f9c649972943b0e787a280086a1f58f625e01eed08116b5c13350a76d3e596f6c2cf343aa43e85995c195e6b2246da2b5e3a52192e796f5fa2c8654fa36a286801a9df318eb1b93aad6f591821a0b8860b1fa0bba214d4551557da07b10a5218ab3b32a9ea2ea89a10f1de1f0a6bb737a12c5ef46479e0dda8dda50cf29f0beca7cfc622d9d8b499583f13b4b72b5f4b11fdc2c19a59b8568a250cd626a5a535b62404f8b3def421ea47db7f303541474e29facb2e620319b3227d3353914b584be38e06f9ef2f65b1dbf331826ca53bc6576506d5e53d96bc13203604d74b685c45fdb18b065ca71334e460ea45fc6bc2e4e08713d5df998c8483536889233cd05b6c40fecd3ab7034eb1c72241e286d2fb5dd5cd517b36b81a39ba6d14f86d9503fb085f5c9eef43efe5de56adc6375d20e3c37aad87a9f19b337e48f85ed89a9283afdd3c7a4f02a266eba26ca4afe83c6d9ced44a4f7d5c701fe729666b1a79b68db866160348f544f22afb5a6da530bafd4f2c8afa8b107c9636d6816cb389efae6a1e3c69be167beaec5f211ef6a2397c09796e2d5d5ec1ed17754e1a104ec9a2d22e0e2668800ab0a1fef5b42f3ab5656706a369dbe046bba67d62a47c5a54a6c2b17793720a0bb22b1624f3ec871e9df0234df7b66a507f614ee47d0a7062a01a146ffd1314e04c5a8c1571e1b0eb3bdc61109611c530670fdaf9489b098785e429dfcf9b77b7c7c3bb839525e8d474d5dac04ab4b97e68e17e44efc811778a014ffc3c274f6bfef5cec4ec5c4fdad1163b00867561b571902182d74029a60535cf8f9ad97c357d77160eb6747285c131ac06e5c28e26ef365197184e9b2def95ecfd272b3bd5da8711cb5de64e0d215ecec2f48373c3424423207e4cac7d024056e5875ce2d83eddff5036e419278c3ffb3fd210b67c7be0ae6a4f6c33a813a32c1a6b288bcaa0f26dd66c9ea612706b90d21446646f5a3e0300caa8eb9f7ebecdee01720ebc5716191c39bb3310289d8e27527679698fe008e370dcdbcdea611a42b58f3d6ee46d4fad3a66ce0d263fdea08a92c49516d436aaf3e7868fca79c66cea5a08fdd5afee1ec9a410baf5f1758e4ccc4683dc99f4af0231c4df2cbe3260861700164b81db0997c90e4821e13b13d4beba3a0ae9cad297d2676c0a7b08c52a3de927d95b74796183376b9970774c502966c805e147ae78b51e635aafb35914d79a28df6a331cc8e86fba7e139bb1f9f07abeecec59dec6340fae0a454408521902baf278e5df4b024c302c8dc615dca49026419095595584809054fc07f5011bf87fb0f19a9aef81bc10dd709613661cd7906db6f44868816d2edb70c23f41f788f152649ad6ab14580832dd0b7ad2ea970c9046d5552dcb620777d9cd10f9cf279c853f158e7484b913cf6a87cd7ef8139946ee159bc1a6155e3d47ccc28e70cd39683b97051ce4053b5391a8aa364e82ad71de3aae36a96208b807eee7639a9b95b2926f78715759ccb4e75a60b95b6f0a6df743dbbb0c6b05e25c4d44d8defc5ccee0ec56af496a3d9e83507313abbb6d6c92dcab853dcc563dbe6ee537eb358c7309b1ee349c39830cabfbce1b4698dd1c44557de4414622de754e844124f6bf1cb8c4dac075d447497505bab6ed468516ff07571527dc8bbb1fd19f0ced2d02d8b21614676102b1a13ae15d41b4ecac98782fbc14be067982879fd28a290591bafac835f75172e9f3d58ba861322ccad13d92597bc0a4fbd5390bc87d1d4f68e247677dd32facbaaf249bc0719fd608f2bfe5a1f4d578d328554f4ab88147078ba317703f3e431868181dddb24452317eeaf306ae001f70570391b1b9288d370743f02d4bebf9e49856f522e9fd65a5cfaab5caccd7f081749be920fddbe066e3bbc78e2f6a0f9961c3b2e6b2d04f67e8a97d0835aae187371f080bc1d04ce96f99c057f581e502a10b76d0090a4ce57e78a5a2af9200e9300f94948ff5d4d3d8bede08c71a0bce8c7b8bc0252eef299ad8d92dfa4d6783b9be79aa453e731c364e9a60f584e26bcd7a9744ecc04267253d3d0648766df8860972a2bcbe881d48dc56efbda5a53f6edf1885b4545eee8320939b081e50f988556455d28cbe6c783144039ee03072e0115604ff27fd6fdee20b04d39f4206655046f87982a0a8e15aff338f17d72b4664d22780f7ea86eb8a55548c0279bbc69b93311835c4cdc50940fa0839b44a892ef6bc671504541f514ffb89866cd496bb977765d4763a7dd5929c74fae8ef0611b8e1002a6f3c8af0af7552cb57294f5f9e82a50a6d2ec3c4a10a2c662080fdfc7541b1532ddeb4f1ccfddf70648786bc32ecfa78b72175a37672103066133804b9d02add7bce9f4ccbc1fd00cce2f6abcba8e05764bafee850fb0a24d1bfa56f1cca634c326f0abb490ac3fd04bceda85ad3199d80ea5ba84a30e1b4faa5b944bbf8e08e061dbd59ab921b0025ee7106a7eb84fa2b3474b74f2b464e03e9a528c608d6435ae19bb6b6d23dece6fc53c08956ac7c03438718ef048b3eb08b6f37586d426dfa3e6539132239b127880ba98eb74be10e7cf536c440c659e59f22994d4538420e73ee80d055e902e39d0d69dc87c7dcfe2e6c9b4eb40dc5fe2e78bb89bc15090514e30d61e5883015f03257d39a7d90e0d139a16201927c7c94f7935bfde30bf07eb7476e9ea8777a1d3056d669d1c9b8cbafbed25ba12ae28a2b504bca12c51ce6041599b700762fe0e7e1ceeece543193935e3708cb93d1d09341f11287c0e94e15193a07b6e74dbb987b6730c3ee8fdc5bca83e575176d6f56f608fc4f1f624b15d88027eb535ed575a28a89cba8e5cc0ad92f9ddba81a0449af0dd98b745146820a161aacfe33c5108274a5a60143319d77d53474007d18d1c39984f281994f65dc13b274a6ef7a39871808bf7468305c516658dbd76a6c65ae0f8ea0e336481e7bdce47e15e0d5e9fd327f6410d3051f28cf60da472473d90708af6df34b2ca8e5fda3031f742797f73c8623170032003735f3ca2b67ce459f3be2f6954a9d1ca1f7b714c7def926e2d51c245d51a3175e66160581ba0c98ab02938941edd066a27ae0f1fde0b86e0fdff5e0b791d15ded8f2402c924a33cce1782bc705cad74c2bac1e4e4f1073aefe5fc174d3556b9894a5d71c693f75528c79fc007cc09f2a0f86c8b4d35c5be2dde471a4def4b61b02459d7f7a6ef58f63d9cad3c0c26057f81e2de3d106b46a5808c24599b2fc028d125161329fabcde966cf20a289953ff5590bd5614a5d83f9b307f74fd0d8e039c8af409cb8b1453183c8471548615bc925c7edb6bb54737f02ad1015dd112b4ab92398e7bf4df75eaa9cda4f62c2690eb0e1667aedac089f0ad0e522514d2fa183f4c05a3a554a8a63aba32fc59db327f34b72dc92b30fa1f41c878b23a2d43c99ef4b52e68d8f58f865864dd9a3ab91005a1f6f9ff0ede8deff178abcf90581643b60ff43692dbd590c3dfd4ab21c36eb4797567a600a179d7724204d6d96fd2aef18e90f6d2047dfc2a32015ff065a894a6ac94b1c27092d6d28ad7cb4b29d6f457812a1f1dce4008432831d990430631c295f476b3206879535c43f36796c1104c9dd028bc5826eb826f9fc38a1b23bd56ec2370af3f7bed58d4a3e31b0751668f610fa57d5e32b26b6a625ea6bea4176b84e46b1e9276081b45063d5ead4967f8aa3d283967092b3fbef9b6bc50863ca92333e41971483dd3220af021d779fe13bd9b14b9757a0c8945077593a465ca9bf3fd79944fd16fc9070c2e323666159c9a5e2c26b79c524677031f464511d5fb61a86ae94ae48707a68d11e2850bad82db11f1d3c0814c03e6c07753b8f9b51d2732ba8ec1e4b71732e9efb7e48f8c690462100dffe00b62cf8ada037d690469c16d10bd806b95ebb449701daa7dd2be40fb2b527188d6b62fbebcfc4adba4041eceba1e21473b1256bb012397a1a01dd17ae8027b210d718d1454228d461b415d588d2af76bed090d14267811ec53648354efedaa58dd28447f3db6cd9aa6a48264d635be0b2cbf775fbe2099bfba4c07b5799bf76a05c02db95e4b0c12212b7b71e8f5e5b02f16fce052056f6ceaccfc6f8308d156bd2b8986e7ecc8ffed3db3940a019015345048eac3e5543cddb3d41de6ab64c30a8c7198687e52d8c056fe4713cab6e2abd0bb8c635158351c3740e78d719167d2a91852a3a3b16372fcdcf5d54a9e5dcd0a6486490ce699931eb1355a374fdd0b2e8068bde6abbc4ee7c1d07fbb7a75bff34f29296053a4343bf37c52277d269de1e01a90034f2ed6fcd054b0db1ac3a84c1b28d9cd797e9cd76051176ed52cf6022e558fb20dbfb1967f770864f41bbc616356e79d431d0648b4bc98f168cf28468625df522be8c1debf498c52aa7d38665c007d5831624b05ae495020b4ebc4c30b54140141c0b627b302867fd46e880e04e2a57f990da21be603697a7602aa1e6c2977cb892cf3fd2dd9423452bf6eac5e7991536d0f6dbe47d809cd53a4d0ed0ebf194769904a718afc995365cb6a211a967d4aa199dc438fb56e92de3e40f32bd2df045b54d78ff855fc7cd209879d389444f28d8843497ad3d7cb14c2e7a855612f2abd5ea1edd8eee9186e8a4049a8fc83f2df7675ca0c52b082b46d9e6aa64441af56d92b3c12e586b235fb7f3e2ee82fc763d344038a911ad22d17b1a92cdb41242a976486d3c1acd87f36b2e8e9609a179f855ab9eda6a4c112f5ddf2f4d2da97c57ec6dec187097346e10f1659074e8106e269bb0cc3097aab0dc342b0ca2c2b2bc8b2b756a584ebd2ba741ea2f7e1ff7018f425fd76f8d8186a311b770cfb3ce17cefea642f986903bd17f251d405d80aadee7afa167b1ea5cfceb8c5da664cc8180caf01503d08fd35afbad15edefe49e15d49d883b01804e78436c30882c0ab7eeaa92335dabfaf3ab826c204249863f6876624149a1c7fe7620f22c3a9475f01703835ed2bcbb6450912244ce334dd7d1d0621d617c78134aa322a4f9e3b37307956c1ec263f7f3d003ee9cc1c9a11ccfbf9b75bc6e4d61818d0f42fb9ff1dfacb5f3aa78fb909060c841eebd222a774e4de70d2c6609e2fd44e256de7a9cbda43bc4b6792db0ea0f2bfa2e3f433368c092222629b82f001632e81993e7b392b6a10a95a68f660df104cc10fe968659291255e06bbc5cdf2b0348fdc47a4ab830a3f3c2441c0b03ea0f3cf79f6f2de162bef95ecc931421a837749e012c60aeebe1e2edcb1036b2e0ba1533cbb7f82b3760585afd085a1c91aa222046ea3c70a8a1edce49d628dac0a1cdb3e8fa19deb18ea3a65658173bb5e8b67a1c17cd6feb4e1cd941ae4cdc8b17d9bf0f62f3d5995845a4c82c05df02019d4c29a9471023dba5a23999d0f8a8142d45f685cb2778669032e09d120e8daef82622f8b02a0119470779a8a58572ef219b54516a515575c64521ff641c21124cbf269d5a237cc13eea856d8c246bc05344d1472b39be0a8ade8ca568e3d35323c57bbef8cda51c4c0ac24a637b5b13f7ac3f11462e7e389a1f9615698d3f645a1bc7f8597756d94c43bf33568f6f72c58ba2f64d9d211b1aa6b4f34efb6c14330dde3e8e937d37e27a097e9e25cbbc96424a1cbba1f39a050e3399c743af6f0c7650445371907c07ecc26c160b5b13fc7149435e699fe39f41b6c846e669f778cb2ca54832641124078d71216d0bc012a2b58138fff256a755f73a41193a74b9179eb998af6f971d320d3dabafe41b53be98f024971ec290b74cf79a772b94d425ba09f18e33a57d4c170809cb8e7a2fdbef41e8ff3cf6e6d300425527e90fbcfb41393b4fe3fad9a5c0646c664278eb6dd702ce0683547a0d05cd080f4d0e428e61e4dfca4b38e9ca210f0f28955068fe522e224937e7f0e21e85f25dd2942abe9697683222ab163c3f177a71d66503445798b69675704ad4afadf4baf2f07271341d66c8e92997485c9a5f86fd08464d05e33c4c73e90398c09255bd09f514614c0a9ff4f4e04efbb0eaadd4cb755fae475e50dcfb6bccd3686362541d611ddc12582e365676b779e35c9fa325ae881ef531ca483f38cecfb0523556806d76e2d0b74fc681128f96d32577f86e615e4052c89640593c4918a04fe43feb6e7ac5731cf8a6976dc3d7c96241e8abc40b945e5bd3ca8df8fc1218ab69b66f24cbfa3e79f84a6e7d2d01c9513c575c48ff8aaa8d0defef5c721af110d2e4c82ae86e4f83ff47fe53de604416ce6664c5e43913b871ceeea5d24ced2270d979b4094a76e8a6c3230c02c276d961b6654a2592f4a64d0444ba613361acd4f7c74531c4ce2403465374aca324084f78428ed4b1949c4e04095768d0481b9282f59201eaf0ae0b7c4dbfd96a60bfe1dc8d4cfcb1f497a935be7870644099c997c1b615805173308c67480573dca793a52467c02c379f779d3c8197969f32aa02315b309f983710a91b2a3eb5303e11dd9eb9066bc1bc8a4cc68baf52a5c6a0427569760c05897bc4b217cbab970751c932ef2f96f8cf314713d982833bc28065c0e7343a18c4011ee89ad905f5d0292d4a7095c81a68f2cebaa8d721cb26700f448c0786cc4067c13c37abc77f5ac127a70aecb7c12649e62095cd2262551f3f8f79d1e1e570546134f8c371b4343e8e356c4acbf8e1233284039ef22f06fb30b1256b17e3d5c71e45232314df09e68c4965d960944d247c7473e48ae1d18a65e54c76562d346dcc423be1eedb842d70c2f6e9b13c424833b6eb6c8cbbd6f4429dca7a63e30234b4420b2f772dea1e7661217ab652b268f6c5c1622a471cd92d6bed96c7294338cd4a8cf11c6e7e2da6e5c28329b4ad5a74cd13604236c450e96f1e3eeba0a682f84d7f8c762c1aaf5cd65faefc1b014324d9a10423ed75a9cdccba5d841e7020351c3f8917fc3f6be3a31e5fbf9bbf14b28c6a409cc6bc582f54b4e03e6194135374dd2b6b8caa40d16b02ce911bf31679c7d15057d9fb341d6faa26361aaa0c4001af21ad147529f3b74862bb9b779bcad1f8447c04bfd389ea573dac6bd0f86cf6809865cd30db00adba2cef0a435ffe9202f81afb947ceea38307e1598de727d778e36533b2aa2d518fd0a2bd7a7ad6a81dbae99e44e5c57d74989c2864e9b858d66e0e5e4519501ef3170423c5d7ef702cb35b843e047f1b765baa0315c6f8b224ed2d26463b165a82681472650824591eb22360ccc48e28e6075815</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>随笔</category>
      </categories>
  </entry>
  <entry>
    <title>《架构整洁之道》读后感</title>
    <url>/2020/04/25/%E3%80%8A%E6%9E%B6%E6%9E%84%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93%E3%80%8B%E8%AF%BB%E5%90%8E%E6%84%9F/</url>
    <content><![CDATA[<h3 id="前言"><a class="header-anchor" href="#前言">¶</a>前言</h3>
<p>昨晚（2020年4月24日）看完了《架构整洁之道》，这应该是我读的第一本Bob大叔的书。其中使我印象深刻的并不是那些所谓“新瓶装旧酒”的技术知识，毕竟写过几年代码的人，应该早在其他地方学习过这些知识了。真正让我印象深刻的是，不论时间和空间存在着多大的差异，面对着同样的问题，“猿类”都有着类似的思考过程。</p>
<a id="more"></a>
<hr>
<h3 id="内容概括"><a class="header-anchor" href="#内容概括">¶</a>内容概括</h3>
<p>对于技术内容的详细回顾，还是直接看阿里巴巴的总结吧。</p>
<blockquote>
<p>阿里巴巴——<a href="https://mp.weixin.qq.com/s/Kd1T40KZWvdThKC3IN6n-Q" target="_blank" rel="noopener">架构整洁之道, 看这一篇就够了！</a></p>
</blockquote>
<p>从目录来看整体的内容：</p>
<ol>
<li>概述</li>
<li>编程范式
<ul>
<li>结构化编程：结构化编程对程序控制权的直接转移进行了限制和规范。</li>
<li>面向对象编程：面向对象编程对程序控制权的间接转移进行了限制和规范。</li>
<li>函数式编程：函数式编程对程序中的赋值操作进行了限制和规范。</li>
</ul>
</li>
<li>设计原则（SOLID原则）
<ul>
<li>SRP (Single Responsibility Principle) 单一职责原则：每个软件模块有且只有一个需要被改变的理由。</li>
<li>OCP (Open Closed Principle) 开闭原则：允许新增代码来修改系统行为，而非只能靠修改原来的代码。</li>
<li>LSP (Liskov Substitution Principle) 里氏替换原则：组件必须遵守同一个约定，以便让这些组件可以相互替换。</li>
<li>ISP (Interface Segregation Principle) 接口隔离原则：避免不必要的依赖。</li>
<li>DIP (Dependence Inversion Principle) 依赖反转原则：实现底层细节的代码应该依赖高层策略性的代码。</li>
</ul>
</li>
<li>组件构建原则
<ul>
<li>组件聚合</li>
<li>组件耦合</li>
</ul>
</li>
<li>软件架构
<ul>
<li>整洁架构</li>
</ul>
</li>
<li>实现细节
<ul>
<li>数据库只是实现细节</li>
<li>Web是实现细节</li>
<li>应用程序框架是实现细节</li>
</ul>
</li>
</ol>
<hr>
<h3 id="摘抄"><a class="header-anchor" href="#摘抄">¶</a>摘抄</h3>
<blockquote>
<p>问题就像有一个生命体一样，它们会不断地繁殖和进化。</p>
<p>大多数人的目标不是设计出一个优质的软件或架构，而是快速地解决一个具体的问题，完成自己的工作。</p>
<p>所谓软件架构，就是你希望在项目一开始就能做对，但是却不一定能够做得对的决策的集合。  ——Ralph Johnson</p>
<p>软件架构是一个猜想，只有通过实际实现和测量才能证实。  ——Tom Gilb</p>
<p>走快的唯一方法是先走好。  ——Robert C. Martin</p>
<p>软件架构的终极目标是，用最小的人力成本来满足构建和维护该系统的需求。</p>
<p>“我们可以未来再重构代码，产品上线最重要！”但是结果大家都知道，产品上线以后重构工作就再没人提起了。</p>
<p>胡乱编写代码的工作速度其实比循规蹈矩更慢。</p>
<p>业务部门原本就是没有能力评估系统架构的重要程度的，这本来就应该是研发人员自己的工作职责！</p>
<p>研发团队必须从公司长远利益出发与其他部门抗争，这和管理团队的工作一样，甚至市场团队、销售团队、运营团队都是这样。公司内部的抗争本来就是无止境的。</p>
</blockquote>
<hr>
<h3 id="片段感想"><a class="header-anchor" href="#片段感想">¶</a>片段感想</h3>
<blockquote>
<h4 id="事件溯源"><a class="header-anchor" href="#事件溯源">¶</a>事件溯源</h4>
<p>只存储事务记录，不存储具体状态。当需要具体状态时，只要从头开始计算所有的事务即可。</p>
</blockquote>
<p>应用程序不提供完整的CRUD，只提供CR。说实话，基于某个政府项目的需求，我真的有在实际项目中考虑过这种实现方式，不过由于我无法解决性能方面的问题，就此作罢了。</p>
<p>这种实现方式听起来的确不太靠谱，但Bob大叔指出“源代码管理程序”的时候，令我醍醐灌顶。不过，话说回来，演算这种做法被我放弃后，用户的需求可没变，最后还是采用了另外建立一张日志表来记录变化的做法。</p>
<hr>
<blockquote>
<h4 id="实现细节"><a class="header-anchor" href="#实现细节">¶</a>实现细节</h4>
<ul>
<li>数据库只是实现细节</li>
<li>Web是实现细节</li>
<li>应用程序框架是实现细节</li>
</ul>
</blockquote>
<p>这句话让我想起刚毕业找工作时的场景，我带着毕业设计（一款局域网直播软件）四处面试，其中的一间公司的某位面试官，在看了我的简历和作品后，首先是质问我为何没有用数据库，然后慷慨激昂的向我普及了数据库的重要性。听罢令我十分羞愧，似乎没有使用数据库，我就犯了原则性错误一样。这一度让我怀疑自己的价值，也怀疑那张省级优秀毕业论文奖状的价值。</p>
<p>也不记得多久之后就释怀了，用了多么优秀或者多么适合的工具，并不能彰显自己的核心价值，解决了问题才有核心价值。用数据库存储数据还是直接读写文件，都只是实现细节，不影响软件的核心直播功能。我很感激那位面试官，面对着一位已经被淘汰的面试者，仍愿意分享自己的经验，尽管语气强烈了一点。</p>
<hr>
<blockquote>
<h4 id="业务逻辑"><a class="header-anchor" href="#业务逻辑">¶</a>业务逻辑</h4>
<p>业务逻辑是一个软件系统存在的意义，它们属于核心功能，是系统用来赚钱或省钱的那部分代码，是整个系统中的皇冠明珠。</p>
</blockquote>
<p>之前持续了很长一段时间，特别喜欢搜集一些工具类(<code>Utility Class</code>)，例如<code>DbHelper</code>。自己也曾一度沉迷于写这些工具类，就像给自己准备了一堆像锤子、起子、螺丝刀、钳子和扳手之类的工具，似乎有了这些储备，就能在以后的代码之路披荆斩棘一般。可实际上，这些工具类代码，使用的频率低的可怕，绝大部分代码基本写出来后就再没看过。</p>
<p>每一个让我花费大量精力和时间的项目，都是在梳理业务逻辑（当然这里包括了解用户需求），用代码实现这些逻辑相比之下倒成了相当轻松的事情（再次当然，我目前接触到的项目，的确也用不上很尖端的技术水平）。</p>
<hr>
<blockquote>
<h4 id="Web是实现细节"><a class="header-anchor" href="#Web是实现细节">¶</a>Web是实现细节</h4>
<p>20世纪90年代的时候，你已经是程序员了吗？还记得Web是如何改变一切的吗？你记得我们在有了崭新的Web技术之后，是如何鄙视那些老旧的客户端/服务器架构的吗？</p>
<p>然而，Web技术事实上并没有改变任何东西，或者说它也没有能力改变任何东西。这一次Web热潮只是软件行业从1960年来经历的数次振荡中的一次。这些振荡一会儿将全部计算资源集中在中央服务器上，一会儿又将计算资源分散到各个终端上。</p>
<p>事实上，在过去十年内，或者说自Web技术被普遍应用以来，这样的振荡也发生了几次。一开始我们以为计算资源应该集中在服务器集群中，浏览器应该保持简单。但随后我们又开始在浏览器中引入 Applets 。再后来我们又改了主意，发明了 Web 2.0，用 Ajax 和 Javascript 将很多计算过程挪回浏览器中。我们先是非常兴奋地将整个应用程序挪到浏览器去执行，后来又非常开心地采用 Node 技术将那些 JavaScript 代码挪回服务器上执行。</p>
<p>一声叹息！</p>
</blockquote>
<p>读到这里不禁笑出了声，话说天下大势，分久必合，合久必分，软件行业也难置身事外。</p>
<p>云计算、边缘计算等概念层出不穷，现在各种3A大作，是越来越吃电脑性能了，CPU、显卡、内存、硬盘，是一个都不放过，为了玩这类游戏，掏钱买个正版还只是拿了张门票。</p>
<p>就拿云游戏举个例子，游戏在云端运行，本地只处理IO，我实际体验了一番，效果的确不错，但游戏体验，就受限于网络水平和服务公司的收费水平了。</p>
<p>本地只处理IO这个概念，在网页应用上体现得更为彻底，例如网页版office，使用体验不亚于桌面版office，但万一断网，那就无计可施了。</p>
<blockquote>
<p>就像CAP的三选二的理论一样，这个世界不存在完美的解决方案，无论什么方案都有好的一面和不好的一面。  ——陈皓（@左耳朵耗子）</p>
</blockquote>
<hr>
<blockquote>
<h4 id="本书拾遗"><a class="header-anchor" href="#本书拾遗">¶</a>本书拾遗</h4>
<p>这一章的中心思想就是，如果不考虑具体实现细节，再好的设计也无法长久。必须要将设计映射到对应的代码结构上，考虑如何组织代码树，以及在编译期和运行期采用哪种解耦合的模式。保持开放，但一定要务实，同时要考虑到团队的大小、技术水平，以及对应的时间和预算限制。最好能利用编译器来维护所选的系统架构设计风格，小心防范来自其他地方的耦合模式，例如数据结构。所有的实现细节都是关键的！</p>
</blockquote>
<p>纸上谈来终觉浅，绝知此事要躬行。再美好的想法，能踏实落地才算。</p>
<hr>
<blockquote>
<h4 id="后序"><a class="header-anchor" href="#后序">¶</a>后序</h4>
<p>我的软件工程师生涯开始于20世纪90年代，那是一个恐龙级大型架构统治世界的时代。要想在那样的时代获得一席之地，我们必须学会对象及其组件、设计模式、统一建模语言（包括其前身）的相关知识。</p>
<p>现在想起来，或许真的可以考虑把我们那段日子所做的事情叫做 “童子军项目” 。每个项目的开头都会有一段长长的设计阶段，以便那些 “高级” 程序员为一些跟随他们的、较 “低级” 的程序员制订好系统的设计蓝图，当然，这些“高级”程序员似乎永远完不成这件事。</p>
<p>于是乎，做这件事的人被升级到了 “软件架构师” ，接着是 “首席架构师” “总架构师” “枢密院首席架构师” 以及其他各种高不可言的头衔，最终，我们还是让一切回到了原点。而我似乎注定要把时间花在画那些带箭头的盒子和编写 PowerPoint 的事情上，而这些事对真实代码的影响近乎为零。</p>
<p>这让我无比受挫，每一行代码本身都至少包含了一条设计决策，任何一个写代码的家伙对软件质量的影响都远在我这个 PowerPoint专业户之上。</p>
<p>幸运的是，接下来发生的敏捷软件开发革命终于让我们这些架构师脱离了苦海。毕竟我是一名程序员，喜欢的是编程。而且我也发现影响软件质量最好的方法还是编写代码。</p>
<p>这些大型架构像恐龙一样在大进程式的原始平原上游荡，然后被一颗叫做 “敏捷开发” 的小行星灭绝了，真是老天开眼啊！</p>
<p>现在，开发团队们可以自由地专注于真正重要的内容，并思考如何为他们所做的事情添加更多价值了。也就是说，他们现在再也不需要浪费几周或几个月的时间等待那些大型架构的设计文档了，他们可以名正言顺地忽略这些设计，直接按照自己的想法编写代码。然后，开发团队只需要安排客户直接参与测试，并在快速设计会议上得到用户的支持，然后他们就可以继续写代码了。</p>
<p>大型架构像恐龙一样消失了，前期设计够用、后期进行大量重构的设计思想和小巧玲珑的哺乳动物一样代替了它们，软件架构迎来了响应式设计的时代。</p>
<p>好吧，无论如何，以上这些都属于理论。</p>
</blockquote>
<p>我此刻便是终日画那些带箭头的盒子和写PPT，如果我对代码亲力亲为，还会受到领导的批评，😂。敏捷开发这个概念，至少领导听过，尽管领导并不理解，仍旧要求我们按照那本二十多年前的《软件工程导论》严格执行。在这里，我不是说《软件工程导论》写得不好或内容过时，对于小公司而言，涉及到公司管理问题，😶私以为，写文档还是比敏捷开发靠谱多了。</p>
<p>但终究还是要做正确的事情，走上正确的道路。如果说博士是突破知识的边界，提升上限水平，那是谁在提高下限水平呢？应该就是政府吧。</p>
<hr>
<h3 id="感想"><a class="header-anchor" href="#感想">¶</a>感想</h3>
<p>整本书读完，犹如和一位老友相谈甚欢，只惜相见太晚，不过，也正如陈皓在序言里所写：</p>
<blockquote>
<p>我个人觉得，这本书是架构方面的入门级读物，但也并不适合经验不足的人员学习，这本书更适合的读者群是，有3~5年编程经验、需要入门软件设计和架构的工程师或程序员。</p>
</blockquote>
<p>此刻的相遇，却也恰好是感悟最深的阶段，幸甚至哉。</p>
<p>那么，全书在我看来，就是在告诉我，对于软件开发而言，什么是重要的事情，软件的核心价值在哪里。</p>
<p>在这里，引入《计算机组成原理》的知识来举例，典型的冯·诺依曼计算机结构里，是以运算器为中心，四周辅以控制器、存储器、输入设备和输出设备，那么类比到软件，业务逻辑便是中心，软件框架、数据库、Web或GUI或命令行都只是辅助。</p>
<p>墨客在面对着大好河山，他想要一支笔，你却给他一把杀猪刀，可谓冬扇夏炉。软件是要用来解决问题，而不是单纯用来炫技的，这也大概就是算法为什么这么重要了吧。</p>
<p>可话又说回来，《计算机组成原理》里紧接着就表明，现代的计算机是以存储器为中心的，那类比过来是不是说数据库是最重要的呢？我认为不是，这需要从另一个角度来看。举个简单的算法例子，如何判断一个数是否为质数，尽力降低时间复杂度和空间复杂度才是这个问题所要研究的，但是在限定范围内，打表才是最优的解决方案。祖冲之可能穷极一生“也才仅仅”算到圆周率的第七位，以存储器为中心的概念，不是指这七位数字的重要性，而是记录传承前人所做的研究的重要性，文化如果无法传承，那生存也就没有意义了吧。所以，以存储器为核心，我觉得应该是认可数据的价值，而不是容器的价值。</p>
<p>这也就很自然的引入了另一个问题，是不是一款软件只需要把业务逻辑（或者叫核心算法）做好，其他部分就可以从简呢？我觉得那也不是，毕竟软件还是要讲用户体验的，这大概就是Linux系统在个人使用领域一直都干不过Windows的原因吧。</p>
<p>达则兼济天下，穷则独善其身。站在顶峰的人，应该不仅仅是为了解决眼下的问题，更多的是解决未来的问题，他们的研究成果可能需要数十年甚至几代人的传承后才得以绽放光芒。而我，还是先坚持公司“以客户为中心”的经营理念来解决温饱问题吧。</p>
<hr>
<h3 id="后记"><a class="header-anchor" href="#后记">¶</a>后记</h3>
<blockquote>
<p>易读、可扩展、可维护、可重用的代码。</p>
<p>简单 vs. 简陋、平衡 vs. 妥协、迭代 vs. 半成品</p>
<p>普通程序员 -&gt; 工程师 -&gt; 架构师</p>
</blockquote>
<p>光阴荏苒，日月如梭，本猿的进化之路依旧望不到头，达尔文可否放我一马？</p>
]]></content>
      <categories>
        <category>随笔</category>
      </categories>
      <tags>
        <tag>架构</tag>
      </tags>
  </entry>
  <entry>
    <title>软件记录</title>
    <url>/2020/03/30/%E8%BD%AF%E4%BB%B6%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<h3 id="前言"><a class="header-anchor" href="#前言">¶</a>前言</h3>
<p>日益壮大却声名狼藉的百度网盘，看着自己曾经收藏的软件名字，已经认不全了，还是要写下来啊。</p>
<a id="more"></a>
<hr>
<h3 id="ShellMenuNew"><a class="header-anchor" href="#ShellMenuNew">¶</a><a href="http://www.nirsoft.net/utils/shell_menu_new.html" target="_blank" rel="noopener">ShellMenuNew</a></h3>
<h4 id="下载"><a class="header-anchor" href="#下载">¶</a>下载</h4>
<p>1.02 中文版</p>
<ul>
<li><a href="/download/shellmenunew.zip">本地下载</a></li>
</ul>
<h4 id="描述"><a class="header-anchor" href="#描述">¶</a>描述</h4>
<p>ShellMenuNew 是用来管理右键菜单的“新建”列表。</p>
<h4 id="界面"><a class="header-anchor" href="#界面">¶</a>界面</h4>
<img data-src="/2020/03/30/%E8%BD%AF%E4%BB%B6%E8%AE%B0%E5%BD%95/2020-03-30-16-43-53.png" class="">
<hr>
<h3 id="Snipaste"><a class="header-anchor" href="#Snipaste">¶</a><a href="https://docs.snipaste.com/zh-cn/" target="_blank" rel="noopener">Snipaste</a></h3>
<h4 id="下载-v2"><a class="header-anchor" href="#下载-v2">¶</a>下载</h4>
<ul>
<li><a href="https://www.microsoft.com/zh-cn/p/snipaste/9p1wxpkb68kx" target="_blank" rel="noopener">Win10 商店</a></li>
<li><a href="https://dl.snipaste.com/win-x64-cn" target="_blank" rel="noopener">64 位</a></li>
<li><a href="https://dl.snipaste.com/win-x86-cn" target="_blank" rel="noopener">32 位</a></li>
</ul>
<h4 id="描述-v2"><a class="header-anchor" href="#描述-v2">¶</a>描述</h4>
<blockquote>
<p>Snipaste 不只是截图，善用贴图功能将帮助你提升工作效率！</p>
</blockquote>
<h4 id="界面-v2"><a class="header-anchor" href="#界面-v2">¶</a>界面</h4>
<img data-src="/2020/03/30/%E8%BD%AF%E4%BB%B6%E8%AE%B0%E5%BD%95/Snipaste.gif" class="">
<hr>
<h3 id="Everything"><a class="header-anchor" href="#Everything">¶</a><a href="https://www.voidtools.com/zh-cn/" target="_blank" rel="noopener">Everything</a></h3>
<h4 id="下载-v3"><a class="header-anchor" href="#下载-v3">¶</a>下载</h4>
<p>Everything 1.4.1.969</p>
<ul>
<li><a href="https://www.voidtools.com/Everything-1.4.1.969.x64-Setup.exe" target="_blank" rel="noopener">安装版 64 位</a></li>
<li><a href="https://www.voidtools.com/Everything-1.4.1.969.x86-Setup.exe" target="_blank" rel="noopener">安装版 32 位</a></li>
<li><a href="https://www.voidtools.com/Everything-1.4.1.969.x64.zip" target="_blank" rel="noopener">便携版 64 位</a></li>
<li><a href="https://www.voidtools.com/Everything-1.4.1.969.x86.zip" target="_blank" rel="noopener">便携版 32 位</a></li>
</ul>
<h4 id="描述-v3"><a class="header-anchor" href="#描述-v3">¶</a>描述</h4>
<blockquote>
<p>“Everything” 是 Windows 上一款搜索引擎，它能够基于文件名快速定文件和文件夹位置。<br>
不像 Windows 内置搜索，“Everything” 默认显示电脑上每个文件和文件夹 (就如其名 “Everything”)。<br>
您在搜索框输入的关键词将会筛选显示的文件和文件夹。</p>
</blockquote>
<h4 id="界面-v3"><a class="header-anchor" href="#界面-v3">¶</a>界面</h4>
<img data-src="/2020/03/30/%E8%BD%AF%E4%BB%B6%E8%AE%B0%E5%BD%95/2020-03-30-17-04-56.png" class="">
<hr>
<h3 id="Dism"><a class="header-anchor" href="#Dism">¶</a><a href="http://www.chuyu.me/zh-Hans/index.html" target="_blank" rel="noopener">Dism++</a></h3>
<h4 id="下载-v4"><a class="header-anchor" href="#下载-v4">¶</a>下载</h4>
<p>version 10.1.1001.10 (2020-01-18)</p>
<ul>
<li><a href="/download/Dism++10.1.1001.10.zip">本地下载</a></li>
</ul>
<h4 id="描述-v4"><a class="header-anchor" href="#描述-v4">¶</a>描述</h4>
<blockquote>
<ul>
<li>Dism++ 无需任何 Dism 组件，即可兼容高低版本所有系统！而微软 Dism 则需要 3 个版本。</li>
<li>Dism++ 是 Dism 的交集，提供完全的图形化操作，几乎支持 Dism 的所有功能以及大量 Dism 原本所不支持的功能。管理更新、驱动、功能、Appx、可选功能、服务、Compact/WIMboot、系统修复等……放马过来吧。</li>
<li>Dism++ 提供了完整的 WIM 支持（包括 ESD 捕获、ESD 转 ISO、释放分段 ESD 以及直接 ISO 支持），值得一提的是，ESD 转 ISO，Dism++可以直接在内存中解密无需修改硬盘数据。这极大的满足了强迫症患者。</li>
<li>Dism++ 提供了开放的清理以及优化功能，用户可以自定义 Dism++规则，来打造专属系统工具。</li>
</ul>
</blockquote>
<h4 id="界面-v4"><a class="header-anchor" href="#界面-v4">¶</a>界面</h4>
<img data-src="/2020/03/30/%E8%BD%AF%E4%BB%B6%E8%AE%B0%E5%BD%95/2020-03-30-17-15-41.png" class="">
<hr>
<h3 id="后记"><a class="header-anchor" href="#后记">¶</a>后记</h3>
<p>小工具就在这里直接提供下载链接吧，大型软件继续在百度网盘里躺尸。</p>
]]></content>
      <categories>
        <category>记录</category>
      </categories>
  </entry>
  <entry>
    <title>陈年往事</title>
    <url>/2020/03/20/%E9%99%88%E5%B9%B4%E5%BE%80%E4%BA%8B/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="密码错误，请重试。" data-whm="纳尼，算了，解密吧。"><div class="hbe-input-container"><input type="password" id="hbePass" placeholder="请输入密码：" /><label>请输入密码：</label><div class="bottom-line"></div></div><script id="hbeData" type="hbeData" data-hmacdigest="d41bb79c5859fde6e20811623907ddd71013ccc2e22d2d27d87333a6f1f47adc">c7bc795a296ae82e521184bd778b84edc5966ebd6130765e0e3f0e30670ba2ecc9febf40b9e70329175b94c7cdfe6d350f6fd08aafaae1b3f0f1f8048d60666607cf94dea1999a3ef83c3b45efcdf5548dab61aaa82976072530c45f02c560bfb3f5e3775cf0f99c3e5f7ae8bd71811b0d4d994254246cd5778429535d7071da9ce66959f2f851c817c501528384b9f889f21ddf89639b48db28143b495166ca9b45b7efdf6490718735a6f387947c714be0e2ee044afa139069caee1faff2757cffca6829604af0b1238f5143008b0017de9c13b8987dce96016204b3a20c513998389aeaadc267f236e3646ca867d79ab5680fac50db0e5c99cfd36ea797dd89fac1315abcaa5c8142b1c5f6ca03e8c781684e866f7117c86426c5b80d462622ba239e6b7718f43c5ab2de9dedac16a9cad16bcceb1dc54ae3727744e1dfdd3cc80a9d4ff0544e905a8a8fec28628e61cd2abb43095e523acad64b1b7335686f4d060e0e8d95c76e6a2f0419e8fdc9c8f72ee1973b6ac4b2c761d6f4131334450d7f4b2a10e7c1f6a746282ece57ae4fb4146fa50f1e5cefc4450e28b2eaee0d0d3dbf4c690dd52a11e41d3a103004d148f1e09a5802bc3ac2d7e4ef64dd981a08639bb5e512d31a4d4a49be0ddc95cc63085f66944cea2518bd8baed4536edf80c9f0bdfc72802d4d3dbefb52099e7267e0e3cfdedef9e9fb1c4c1a4c111cdda9bb4b614a6b0acd9da1ee5e295c7380b5297657f24b554d68b3399986d954bdbab30c9c65b59441af4923032f94d1abe9581a2de62e12ce66f775245c066702c7960a70164ea3b4b838f996445c3b269a3526c16a1bf88a1b2fdaf6b9ab8b4f06705fc5d05a1b0f51b4bbadfbaed8eb431c18b2a029cfe42b82261f80aa9fb89e867666f70c359ef2fcfad6d2963e6aeb1c43fdc6fab542ed1b9eff9f5f9462d5d2ffac28c1e469e08ffa43deaed31037fa51ad4bca26f85cc573d78646a410b761b34016960b8ade25ea438eb04fdace7849fa565953ddd1a83631e02ec4bdd3e782f4fb3c55770dc01616b9cc11151088978b4f8fe3fc22139b5f9efffa78e4ceb96a43fca557b539ea9449a4df9b8abb4745790d13cd14ba859d2fd17855434c79078f1c4dcc3bb3429e375a21243dfa16e59a074a55d0d1dd35a9a1385141f580042cd91906babe05a9fe2ef6ff46845c7d54d33c4b8328779f1e33f89e1b8bac9ec772c511fa3796a713b47d3e79e4ee8dc408d790b7d961629e8b5acc2e65b8682f489e272482a073f1f8a29f46b383dd014fa890af82e91004111a4d4ba7e3b7a4873ba85e497ba62eeb9c3c5d9dbacca01dd3a3f57cc80698a381dd1caf83316fe6cf0f5a91d4f856d68e6269aed39f3c7559f17b47df0c380c2b854b3dd55e4c609934f434dd31d96e49a6d69d1719040cfe647e01ce5422bdf417658a0549b5dbf1759ebfa0a7929781803dd1e63ebb3c1cf9a88674c51fe0b9c601e792e4a6e243225abd6a90b2f7256ef2e479896a6a52a7255dd683f67a744583b037a3efb1ade4431a394ff22df9d26bdae5f294ad9536131cc93af4e6723e69a49bc22c15672d2db199004ea0d6260227e504be832f6bbaa1f43b9b2b0d037bceb3473a5966c91857ca5e632f8a7afc6361b3c1e336c40b7fa2ba90db0f084a8dad4423f3ab77869c6062ae738f53ef72601d4f1165acd6d973b6b47af84c3908b1009dc6d0224c5d29a1e65183f08b935ef68c567666f1593da47bb901c33ad56cf5ddac11f5df35ad1b4e54f4fdac01111eb170adaaafe53623237cf4df6b6a37f73c1aca5584d66924e9b0494d4b4cd7563d790aebb748079300a25cb7519d3045d7093d70df1c974ed6e83c3873b77581fb716d2a60e60fb79c0be3346397234908616fc94fa4f932689a7a0742bcef9203384938f1b0f535904bd42925905bf5c7afa6c84b114f71ddf9d6fb79d9267528896ccc740e3604c6fe132ead3394d951fdcf104c0a058b2f173bec05e905a461d30fea24ee0435b87c16e648ac1846a920b4a797923e16a23205742341605f854bb4bea27b519973723ddf9a3b104f43c43c70b9125d2f0568d9dea5187bc9d484b0e7284b78649c9910edc4d90bbb8637f6a6d37f4a92b889724a96331160bd8fa2b8ba76417e94b907d6660040d6aae44cc875aff1d992b986f151f021d1eb1415c7759248b7511d15fa2afac083390a9a5dd4717183e806799130a951ea056cf87c4a5086dfe00ddace3e8ffe632fae1544721433b6b19ea4e5a65c718f2f703ce61c75a8877450bb8d094b63bfaddcc04884352cd0b25f80f2bda8d13db86e435481a5ced129825c1a244856b5d696e0a34b3590eb59c00f55ed0270aadab72158680ef0ee982c3b9d4072bfa283e0cbf782de9626ef5dc14a9f95e97ee8ea9a7633fa918aa37ae65dc496f3006fd04c3505ec367b4870d7172b27adef59a5b8e5c0bfd7c26bbc6bbfdee2feb44f235131b84311a6afdc285e5f8943919208abddb90feb9e5c1da6ab6c8e8b25ee287ac79246b6841494a2190e36814ef1c11c02045d6bcdbd8788018ba2672c8dd4856dbc64d6c5290df17e7502e5f7c3ebb3df57282f4b7f8a530a5a16ee5edc7a2125d316a52bcb6371f93af904c0bacd3f2f726e763b65281b56076a3eb068aab83fa3848ee1d93b14a0e3b1dca179d9ffbb67c088fe704d2cc9bf0d5249c6d4920a7f1bdf1828e629da17b5448c35162aad6e54d651a3598b483c73e3b1d2c8557fd4cd2fc3850f478a3ddd2574e94e94dbc5f255102c9028b56e84fa2953293b0744d1e34006303b575681f1a4bcd3c19108d148255be2348329bc922a6c88dfe7511307244f8077644b80efc1a66fcb805bf1f600e40b4d1a6b755456f9f00e09971085d342fe530866a1407d8358b0cbe4cbcbee086233702c89663d5d96075316a2f5d5e5dbac450dd812637d3b26e10a70a089dacd59e936e74c8113b0491448f3ab46177243e3badd1689afcd5f1f9aa54534e85454fe6111f7b6f54851909a3e947c8066e7e7058f7e89ea39e7e3dde3eb0e3778d5d1530887227bf722a77b8d328fa8ec18e448495655062d4cb56437d494710ec3d7a9f3f83815727d2d12c286e791b96ab4688b4c1126eef1417ddec0bcac44675e22cc8d5e3779acbd309f1d4d8aa7fd805a4cb2b13d0632e30e2e5d58a54b7379e302f8e43e93f9b2312d450de1c1d8b2993a657b777a586b5196c64e33eeda8c65c533a58e5bde9699bc06896a1bdc2b22e94e4e49768ee6e77dc29e99a8a9d7529fe0769c7fe17921b97011536f8607e15ba6abbfe419af368bcdbec60b112f90663ff7395a512bace00fd28f1b0e617bb59585cf3be1dd9cfa148694f6dcbdb9b147f617159c19a45d4b4c0465e49d9e30c16c376f144130626fc4693352ffce9559ebb7ad8df816a36af2baca315ffe408b17ed2805921366bd0fe3eb974dbd76263bac72d5ea6ef51353705da42b8c966719b2339591ff51e891107ab7b852c54d7c867f54b73ea7ab2f35b6ba9fa5f697261adc29ca86eab3b06ee978ff5f92801028c07df1748427995b9f6e240e1faf07fdc6842843e0553bf4e4a6a88a1f117f9807b0f4e7042aab5d961dcb54491e3399d14511f2137e81ff986978eec784f326c1adc034650544c22b48ce1f30069422b02b2b49f8e027579bf9fd130e448d0ecf82bb224e615c138dc870e0e5ccb27f111ed3286b6828bd8c614a68af54573cdaa873bbf64a9f02809aba6990be78fb93175d67653dfb80daca569e34a938cf42e9a83bb1318f23b7264104efeccf1ed2249b34e8ec2da91cf6e2504b0375434b690738d12275d3a53ef5b11ae9799a961abe7fa55b3f98879e4ef03bedd345a3237ac0d4420e436f53fdcfcd8362ae7b7dcad1cebbf1f547fa8b89e451d21f6b231162dd7b17ad5f106feefbcddd7a5de2e444714d33f4d1c47933641ec76962be3d629d4e05f99d4d99d05c1bbc12cd7e85b8e576101b33c217a3718d6500db1348fefe43221e8643d5694885ca47b3b36655c32e875ac674faad7b8effefeb206f70e25b2d154980ece086b363ce120ea37680d253b49cd36d3fddda6573a2805a6ae3eaf7a0e93923a0c65d22e063a1ab6eb23df35675b06039ed97de0a2afabea2f171465b04829bec70781568937b29cecc10e076a1e06c70adb31aca98e42e361d4ba6596ea471eb7f23613505ccf090470aea5a4c876aa034ed05a7d10773f634bea86a364421b89620df1f864f33cdc1d9421b0276402f340e1308b1174f7aa4213e90b42c779c0c9a72b1f71d0a6195f7590d353b05520b9a86615b220795201a356a2b7bae0a8c8301522e8f0fbad3a310532c97d7310a2834994c1287f7cc1be994a7cc84118bf4a992f2c9e4fe911c7a85ade29224ebbdf4df8fb28ebea2dabed6a514b12ea203a70150e138c383a29783d6afaa7df0e55047505d904e903f47fb809a9dc7d867de2d982cf3a7a784dc0d42a37db30d6b19e1bcb503b5166f2b3b355d0be03522affd6b3fc68f8e8c4c8cfc34c1c1e4a399c2cb489db2d63093192c09955e33f6c642b52580a9076dbeb4ec5f741bccf89fa046fecc60b677302d9d2fc8ab950444de8f60a7613c8677ec221a9f6acf6e6ff66fabcc47c25a1399ae71dc7edfedada40a5df354a77e9f8b917fc8fe0b0ad3950f35c301aee0e74ff8445b000b4085f85303582e5221ca773edbdccc4ab7be0b8b48c12eec0de7407f9caabe9af552add80abb0b02c90b4d53762b45eb2d27d91fda0175a89918ddb8cd9561ee987c4b4ca0e7a14c09f5d1fe11021f1a47c2e67f23667d3a8c593d93ffce9d82ec25325fb4f8501cef3f26ae1bfae3a2d9594fef2afbb91c92e2db9aadd6922008b4185aa18e4ccf0396a8eb5c33bd8b8c169029ef7f0c45c68d722b72ee554a1f7187f2cb1b4e91be6c29d16920ac814e77a82b8c0552bf911d1e6dd861a0681141e67d7dc7585304ffac326538434a826ca2058728c76ef78c4fcfbebec036696be1d8705b38ca762b2b30e29f8f425b85380231aa5840bc936f488541a5dc8062aa46cb8773a310d9a91ff5e0bc8dd5a9d172a063cf9dbecc8b98e5d54eee77596f05bae8d0d8a5a3fdd8c4490adee4c665a6f23e8a2db5a0cb098df0da17a87ebe70d06db8eae31e3dd88ab61566ad7b52c3ebeeeb55344a3cb0183da3be67421196586e0c206a38ef64a6b269041fae2b004d980368cce8b4198d06108587b12ccdc2d50cbfd0ae891dd2d8194c21dbb4ab3adf5d766798ac0427b6843464839ce97bc907e250b215671160e74555194ce85541bc0c68c6c84394b99d09c461e9ecab1e1a00dab9f43dafb1944585f4563c46bb9054687e0d94f76f9d495dbf6a0a18f6736063821cfe75241b9ed623f47032d636d273b5eb69780788ef29410c4c0247389a24e1c49cf66bf1dd74e26655e107c7668c73eba42f51af041f0c517a7bf7636074b9a9340ec5daa0b990ad661c6594e2968514521b43c4a544be85020b9524f09632c8a9441eaa7941f69f25e721483fc2928d12bbad7f8440b4a5325f90116d8df42770abcf90d1aa96c8b8f5e21a8a32f3b60cb948f9fcdca10c1fa79413581ac5a76c942015d5c662aa2ec8ec883c5f4fc95a84ddd49f4ceb3de4b63512662f02ec60ba0b880dddceacc24076fe0cb0ce7cd54f1474a74f354a4511a1a3b0ffd1d589bc18e953d25eaa702decb98114325bd5c20a2383553ff6d3f7f00ce0fa8d9a50426bb3ce4af4e21bd0a620fe048462f5eecd0dc998eb091540e5b3f385e15a21b52281225de97b4e39f94fe76ead16521c5cfb0067cd7c2b97ba3524d1c8e3a1adca87d5877f963d3ec3c52b0cda11fb512a36f8bd5ebd224e5e0d67b46d54d7fc4feae44d068d1282dcdcd5a1d7d0974b255528cb83e06c8b50f22fb7903b6bd3707888d3da262f09ea79f5f5f106612cb641e22e740b744712949e9ddc7f5c68c4a1d2af8249de1058bd327e50febcec52d290d408b20f8ee1ae36562fb121ee3e3d155848bd39b0cbf4728a2b1175d80a3ce68a4d6d77ebe13f493b6e60fa283ad17b50fd408a96475c887e0961cc479367905fe5dd7130b233bf784673207ecf5b164204b4d307c6764647d531856e7bc088269507eb1499878d463d422c658deff593734a1ce69fc4b73bd749397d3b69ebc7f67ad06eb80e77392950c2ba4fa4377c0d3e3aff0d44b46671e9298dd0b4a095dce829f8ec56cf49b6b2ba22a6f6e6f7c95404dd501cbb64e26f6c736c07f4086d590f61faf38ca7fd7755800bb5994b004b13464cce352e9054d53fe1f2a7d23f73db47101968c899a470443bf317d048638be9d21289dd32db2fc2e98d5aeac63bbca022b52de7a652aa456f4d4829c0a1618376ddbbaddc70d1a4517e0cc31ec1e72a356f8e9aec030401628eed44a519eac9d162faed810a587661b77ca2c3d2d7288f4364e740a2a20d8c0647d2836ac9493bcb720b5f055c2102a58ddeb3a9fc7c10ff25fb18126209a4206567a6aa7c44d79608448c8e1ed0e56bbce7407af072ce6f9b63b856e3f6d9a0e957a110e547e40cda88da5e2d390343c685bf2bced4ca3eb663af5b2654bc19369e2cb9de8fefb658f0ebf1a7db893598cf4858e59daf6d8d6a8be7d9b7a13e872d0ada6635aa0bfe1ace304a37e89e11b7f65b5dc100d5ff89a90b5bfd8ca8c58ddb0aeb404c69ff161c517585abaa6f46dbfb1bf8a5033a2ed6bc0bce7bfeead1b0b295b1003568af4286e7313d59ac2452f58c7742189b9414b822339b33b3a1774199f39150a74c9a78fbf4438f59732bcf63b134a9f4a4a51d6e0f3ad69177310b5470156585bc1214f785093050feb2f9ba8f9b14f7f3512e8affe1eee2be12eb96ddef996bbc9488ea71ef1c965719cc35d214290fbac7f4111c99170c465b5b05901e47f76ec0867866500bd08b2c0bd298cb2cc283e34b742ba013d336a51280516240566d064969a9a1e08893c822db8894147e5dfa3d0dbd6e343cea9ee4a61ea0085cac3f39744548d06527fdfcaf6363ffa4cca2cbcab18ad776495c1e13e443aecbb0828984a1857880d5e84cbb2d5ee8deb1a16aad866c65d7572c22b40fda5bdb4159abd00c1bc5a1b9c4e8be9045068800071ab7c3aade67fe2e7a5a6546528354dc34f93f542155f5fa2ac38a5a28ce1797d249550f830649883fa70e110284fa694bf6fb40dfba9aa9224d834edd6f8d1d514f8245e9fc9fe14c847d0ed3424c94ef816c787a5c3d0caf05437891759709785716d592ffc8e3e630421db077a5c041800241fda4e7d2efcd187ad978574a99242b74cd0b628ad455f321878cb1a17fd24cff23b1ec7b59395a2291912fe0a9d2acc6aff520a40c13d0f322a0283a2861fdf0126f64d5d10a1d07612ef6d9647444ce55458241218dc91e250fe9b7646782287fdc7b80da085d8bb1081882f378fea2e0018ac9019670c736232317fecaf32831dd5db887994fb449eeb3e7d24c79e5161052bde83367c0dabf0210ae8026a5a6473dd02d8d11abee3483a3cc0b290538db1067849886943ead365dac170f0233dbf6a2a0a44ac79532dec9f7f35c1c3b452def62a8f341ea3ffd9dd2ae06c9f0c32d31bb4ce4826f8cbc82659772abb6e86998c4242ca105de522ce536758608bd39dc52f80a56dc9660f9fc868896d85efd41da6e63e9f058d97a83af7d73cafe5a8279040fa972d5c620d11ba35582121055a2142f659cab85f7ff67e7bd0e6fab883cde6350b9a0ca3e028a645e12eeaa35b9918f2f92a80dfe901307cc4857b20034eb67e3a1176f0a136ff0d947a035cd0bd003693ef9731fa7797d8ab98287269be3113354b74a82e8357da65a2d0c94b4f5dd044d6293aa0f2a775b7cbdf6e6136e15fea50aeb2e18ba5ec871c07628542f144b17a93fbd977b8783fdcd85bed23aad2c0c25665c77873a43f20b3665ee3499d59f4db56c69013b1d8fab18ef120a7141513f180d514308671d5e71ca76beb5f28c9d64376dd51cf226d3fd14e4f8b964a8126740022d473b8a547cb9bb4b859ea89235f65b27631df44b16f771ace379a645e6a2ef45ebea69a519ac1cd649d4f4559ffe03da9e94022331e7cbdf4276dbe1410b1cd91eb17b8fd793268e39c3ac03b5643d13dde29f0c65db743f08ac05abe3d584d9add265ae6940f55bc62b67dbdbca2848ceb0cf36999d1a3a55b8145f85244358a4188cadc3acab25daee870c9c8fc4a244288af47426bd6e0f4e7c9ce703d935ea98995a774c3a26620b33e6f8a62c184910fd13de398bddb3e2de89b28dddb701b2e353cfca8d8b8ed3136cde8c1534f3e7ef3cd95f901e5ad840800e63427a63a3719f805e1af5929985f4780823b21fb19678c28e3c287ed5ba58964187301e6d5d6091896c095a484d099fe0f03a90ab5e7e4dd410f465ca0f8a41e0139f4bc2ecd6d822f67e9755400a73679a3af8a1a070125ba2ebf3e00cdff6101cd6cc4d47871fcbc794b3510c5afc54f91dd5f9738cdfaf670294f72a4d91dfcdca494b12f148f4a28831269ca8963eb216bda2187d0af97cd4353503834959ed3d17132fd16b0a429f29b86c938a52197929d5db01b9ef62b3e16f4de35c5fe8cb5538899b6f1737d15113f028be19b770c677703dc10c193331c6870a9321115811f0d3d22018a6fa7e0dc608e9f2848cc997f3e79b4a3d65014566ca1153cccc009509f90a6a09f48962ea6f64380cd1950d29a7e5ab2607e11cdff41a8a8f015850e73ce6e05bbb4755ff0e0a90814d2ddadae4d6d569d893ee90e5c39d70add3fbd2902f2dd66f8419e88fa234595a40de98eb9862f016dae8010d037370a1ef290569f806265cc58671cd86cd2bfff5665fdea4bd60942661b9277446c49f3d51e8188fd15e389ba71d4e811ab99423ecb47c11d38fd105ce2dd365bb2ee758ae6382725342a8dc71ddce3c8e6d7e9c04c585ce6e868b0a1a924e8f014a7e92a6ab5dcfbd040db450f7db6994ed1278091b4320c1e2112eccfafca30c2be9a473ad30d79b843432763ddf3a43f71298b14bde3aba295a817a3153f74676cc0430101cf95bbe1d7e7f0a6de30357ffe7ccb3e3d774c6b0036dbcbdb0c6515ddd5e634d418dc26d8c7656e70f6079bb02655320208c2a2b1dc7d1f7b8cc176b52fd39d844c31865b30e92893cfa0ee5e2</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>随笔</category>
      </categories>
  </entry>
  <entry>
    <title>浅谈直播</title>
    <url>/2020/03/19/%E6%B5%85%E8%B0%88%E7%9B%B4%E6%92%AD/</url>
    <content><![CDATA[<h3 id="前言"><a class="header-anchor" href="#前言">¶</a>前言</h3>
<p>借着这次疫情的机会，已经平息的直播，又一次被唤醒。像钉钉（视频会议）、腾讯会议、瞩目之类的软件迅速冒出，不禁让我想起自己的毕业设计。在这里简单聊一下我的毕业设计和目前的直播平台搭建方式。</p>
<a id="more"></a>
<h3 id="忆往昔"><a class="header-anchor" href="#忆往昔">¶</a>忆往昔</h3>
<p>大学的毕业设计，我选的课题叫做<strong>多媒体电子教室的设计与实现</strong>。</p>
<p>貌似全班就我一个人选了，连个讨论的人都找不到。😂</p>
<p>这个课题简单来说就是设计一款局域网屏幕传输软件，方便老师在计算机教室上课教学。</p>
<p>如果你对“方便”有疑惑的话，我就描述一下应用场景，印象中大学的计算机教室架了四台还是六台投影仪，幕布摆放的位置也只能穿插在两排座位之间，这就导致投影的效果很差，大部分位置的视角都很别扭。</p>
<p>另说，那时候是用飞鸽传书来互传文件，比如交作业（代码）给老师。课堂上理所当然不允许讲话，所以咯，我们经常用飞鸽来聊天，搞定点爆破（针对性连续发送文件）。🤐</p>
<h4 id="作品"><a class="header-anchor" href="#作品">¶</a>作品</h4>
<blockquote>
<p>C#写的 Winform 程序，实现了局域网内的屏幕广播、聊天对话、举手和远程开关机。</p>
</blockquote>
<img data-src="/2020/03/19/%E6%B5%85%E8%B0%88%E7%9B%B4%E6%92%AD/2020-03-19-19-05-20.png" class="">
<img data-src="/2020/03/19/%E6%B5%85%E8%B0%88%E7%9B%B4%E6%92%AD/2020-03-19-19-05-34.png" class="">
<h4 id="过程"><a class="header-anchor" href="#过程">¶</a>过程</h4>
<p>已经不记得当时的技术水平和具体思路了，毕业有点久了，只能捡一些回忆来讲。</p>
<p>首先拿到这个课题，大脑里简单构思了一下，主要就是两项功能，一个是屏幕传输，另一个是聊天。</p>
<p>作为一个度娘养大的孩子，凡事不懂先百度的习惯已经深入骨髓，搜了一些信息，就盯着“红蜘蛛”这款软件了。但是很显然，我只能看到一些功能描述和界面，具体源码是不可能搞得到的。所以，只能自己动手了。</p>
<p>屏幕传输，简单点，就是连续截图，再连续发送就完了。实际用代码去实现的时候就发现问题来了，截图好说，TCP 发送好说，效果就很不好说了，开启广播就有巨大的流量，但客户端显示效果极差，比放 PPT 还差。</p>
<p>遇到问题了，再次请教度娘，借鉴了网友的思路，TCP 是不行的，既然是有指不定多少个客户端要看到画面，而且要流畅，也就是说丟几帧画面也没关系，那就改用 UDP 吧。</p>
<p>用 UDP 就发现，UDP 单次发送的数据包大小是有限制的。为此，服务端又将截图进行切片，又给片段进行编号，客户端在一小段时间内对这些片段按照编号重组，如果编号缺失或者超时，就直接放弃这一次画面的显示。</p>
<p>换成这种实现方式，效果出奇得好，好到我准备的其他优化手段都用不上了。在局域网内，没有其他流量干扰，屏幕广播的延迟不超过一秒，流畅度和看电影差不多。</p>
<p>聊天，那就更简单了，定向 TCP 连接就完了，不谈。远程开关机之类的，太简单，不谈。</p>
<p>后续就是拿着软件，改了三遍论文，就去答辩了。</p>
<h4 id="后续"><a class="header-anchor" href="#后续">¶</a>后续</h4>
<p>答辩结束后，老师说想将我的软件实际投入教学使用，我那时候考虑的是，这个软件目前远不如我的预期，但迫于论文答辩，只能仓促完成，便婉拒了老师。当时还想着毕业了再完善一下这个软件，等到我自己认可这个软件的时候，再和老师联系。现实情况是，毕业了就开始忙着找工作，早就忘了这件事了。😅</p>
<p>其实，作为一个电子教室软件，界面丑我是心知肚明的，对客户端的强力控制也是一个重点，奈何当初技术菜、时间短，就写了个 Kill 任务管理器的线程，然后在启动广播的时候把客户端置顶；另外，虽然屏幕传输实现了，但是音频传输也需要考虑，在教室四周摆上大音响的做法太不计科了；还有聊天功能，也不能只是纯文字聊天，富文本聊天、传输文件的功能也是要加的。</p>
<p>基于以上种种要做却没做的功能，这个软件我自己实在不能认可。</p>
<h3 id="看今朝"><a class="header-anchor" href="#看今朝">¶</a>看今朝</h3>
<p>直播行业大火的时候，我就了解到 <a href="https://obsproject.com/zh-cn" target="_blank" rel="noopener">OBS</a> 这款软件，简单上手把玩了一番，发现此乃神器，全方位吊打我当初毕设软件的理想终极版。先简单说下直播的技术。</p>
<ul>
<li>知乎：<a href="https://www.zhihu.com/question/42162310" target="_blank" rel="noopener">如何搭建一个完整的视频直播系统？</a></li>
<li>博客：<a href="https://blog.csdn.net/kingmax54212008/article/details/84307500" target="_blank" rel="noopener">直播平台整体架构</a></li>
</ul>
<p>直播的技术架构到如今也是很成熟的了，毕竟活不下去的也差不多都倒闭了，先来盗些图</p>
<img data-src="/2020/03/19/%E6%B5%85%E8%B0%88%E7%9B%B4%E6%92%AD/2020-03-19-21-04-09.png" class="">
<img data-src="/2020/03/19/%E6%B5%85%E8%B0%88%E7%9B%B4%E6%92%AD/2020-03-19-21-10-13.png" class="">
<p>简单来讲，就是有人主动发起直播（推流），有流媒体服务器在处理（分发），有人在看（拉流）。</p>
<p>我尝试着使用 OBS、SRS 和 Potplayer，在我那 1 核 2GB 1Mbps 的小水管服务器做了个测试，直播效果很勉强，有明显的卡顿，但至少是有效果的。</p>
<h4 id="OBS（推流）"><a class="header-anchor" href="#OBS（推流）">¶</a><a href="https://obsproject.com/zh-cn" target="_blank" rel="noopener">OBS</a>（推流）</h4>
<blockquote>
<p>OBS Studio 是免费的开源软件，用于视频记录和实时流媒体。目前可以使用 Linux，Mac 和 Windows Build。</p>
<ul>
<li>官方 OBS Studio 构建：<a href="https://github.com/obsproject/obs-studio/releases" target="_blank" rel="noopener">Github Release</a></li>
<li>手动构建 OBS Studio：<a href="https://obsproject.com/wiki/Install-Instructions" target="_blank" rel="noopener">安装说明</a></li>
</ul>
</blockquote>
<img data-src="/2020/03/19/%E6%B5%85%E8%B0%88%E7%9B%B4%E6%92%AD/2020-03-19-20-55-56.png" class="">
<h4 id="SRS（分发）"><a class="header-anchor" href="#SRS（分发）">¶</a><a href="https://github.com/ossrs/srs" target="_blank" rel="noopener">SRS</a>（分发）</h4>
<blockquote>
<p>SRS/3.0，OuXuli，是一个流媒体集群，支持 RTMP/HLS/WebRTC/SRT/GB28181，高效、稳定、易用，简单而快乐。</p>
<p>SRS 定位是运营级的互联网直播服务器集群，追求更好的概念完整性和最简单实现的代码。SRS 提供了丰富的接入方案将 RTMP 流接入 SRS， 包括推送 RTMP 到 SRS、推送 RTSP/UDP/FLV 到 SRS、拉取流到 SRS。 SRS 还支持将接入的 RTMP 流进行各种变换，譬如将 RTMP 流转码、流截图、 转发给其他服务器、转封装成 HTTP-FLV 流、转封装成 HLS、 转封装成 HDS、转封装成 DASH、录制成 FLV/MP4。SRS 包含支大规模集群如 CDN 业务的关键特性， 譬如 RTMP 多级集群、源站集群、VHOST 虚拟服务器 、 无中断服务 Reload、HTTP-FLV 集群。此外，SRS 还提供丰富的应用接口， 包括 HTTP 回调、安全策略 Security、HTTP API 接口、 RTMP 测速。SRS 在源站和 CDN 集群中都得到了广泛的应用 Applications。</p>
</blockquote>
<img data-src="/2020/03/19/%E6%B5%85%E8%B0%88%E7%9B%B4%E6%92%AD/2020-03-19-21-43-28.png" class="">
<h4 id="VLC（拉流）"><a class="header-anchor" href="#VLC（拉流）">¶</a><a href="https://www.videolan.org/vlc/" target="_blank" rel="noopener">VLC</a>（拉流）</h4>
<blockquote>
<p>VLC 是一款自由、开源的跨平台多媒体播放器及框架，可播放大多数多媒体文件，以及 DVD、音频 CD、VCD 及各类流媒体协议。</p>
</blockquote>
<img data-src="/2020/03/19/%E6%B5%85%E8%B0%88%E7%9B%B4%E6%92%AD/2020-03-19-21-30-03.png" class="">
<h3 id="后记"><a class="header-anchor" href="#后记">¶</a>后记</h3>
<p>依旧是留坑，看啥时候研究下 OBS，给当初的毕设软件换换血，再顺带把远程控制的功能一并做了。😁</p>
]]></content>
      <categories>
        <category>随笔</category>
      </categories>
      <tags>
        <tag>OBS</tag>
        <tag>SMTP</tag>
        <tag>UDP</tag>
      </tags>
  </entry>
  <entry>
    <title>浅谈远程桌面</title>
    <url>/2020/03/17/%E6%B5%85%E8%B0%88%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/</url>
    <content><![CDATA[<h3 id="前言"><a class="header-anchor" href="#前言">¶</a>前言</h3>
<p>为了能够流畅的使用远程桌面（GUI），我尝试了多款软件，也查了一些资料，在这里记录一下。</p>
<a id="more"></a>
<h3 id="协议"><a class="header-anchor" href="#协议">¶</a>协议</h3>
<table>
<thead>
<tr>
<th>协议</th>
<th><a href="https://support.microsoft.com/zh-cn/help/186607/understanding-the-remote-desktop-protocol-rdp" target="_blank" rel="noopener">RDP</a></th>
<th><a href="https://docs.vmware.com/cn/VMware-Horizon-7/7.2/com.vmware.horizon-view.installation.doc/GUID-E2FFCC1F-B14A-4A4E-A36C-994EACC542B6.html" target="_blank" rel="noopener">PCoIP</a></th>
<th><a href="https://en.wikipedia.org/wiki/Independent_Computing_Architecture" target="_blank" rel="noopener">ICA</a></th>
<th><a href="https://spice-space.org/" target="_blank" rel="noopener">SPICE</a></th>
<th><a href="https://en.wikipedia.org/wiki/RFB_protocol" target="_blank" rel="noopener">RFB</a></th>
</tr>
</thead>
<tbody>
<tr>
<td>公司</td>
<td>Microsoft</td>
<td>VMWare</td>
<td>Citrix</td>
<td>Red Hat</td>
<td>RealVNC</td>
</tr>
<tr>
<td>特点</td>
<td>本地显卡渲染</td>
<td>传输差分图像</td>
<td>增强型 RDP</td>
<td>KVM 虚拟化</td>
<td>瘦客户端</td>
</tr>
<tr>
<td>软件</td>
<td>mstsc、FreeRDP</td>
<td>TeamViwer、Splashtop</td>
<td>Citrix Virtual</td>
<td></td>
<td>RealVNC、TightVNC</td>
</tr>
</tbody>
</table>
<p>另外，AnyDesk 和向日葵没找到具体协议信息，我个人用起来感觉是和 TeamViwer 一样的。</p>
<img data-src="/2020/03/17/%E6%B5%85%E8%B0%88%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/2020-03-17-22-19-32.png" class="" title="盗图1">
<img data-src="/2020/03/17/%E6%B5%85%E8%B0%88%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/2020-03-17-22-19-42.png" class="" title="盗图2">
<h3 id="建议"><a class="header-anchor" href="#建议">¶</a>建议</h3>
<ol>
<li>偶尔才用一次的朋友，用 QQ 或钉钉的远程协助功能就好</li>
<li>首推 TeamViewer，综合实力杠杠的，虽然经常会检测到商用，然后就不免费了</li>
</ol>
<img data-src="/2020/03/17/%E6%B5%85%E8%B0%88%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/2020-03-17-23-05-06.png" class="" title="TeamViewer">
<ol start="3">
<li>自从 TeamViewer 把我 ban 掉后，向日葵已成为我的主力</li>
</ol>
<img data-src="/2020/03/17/%E6%B5%85%E8%B0%88%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/2020-03-17-23-05-52.png" class="" title="向日葵">
<ol start="4">
<li>其实 ZeroTier 等内网穿透方案，配合 mstsc 或 Splashtop 也挺好的</li>
</ol>
<img data-src="/2020/03/17/%E6%B5%85%E8%B0%88%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/2020-03-17-23-06-26.png" class="" title="mstsc">
<ol start="5">
<li>mstsc 由于是本地渲染，导致我远程玩全屏游戏的时候，会提示 DirectX 错误，具体原因待查</li>
<li>Splashtop 的控制端和被控端是两个软件</li>
</ol>
<h3 id="后记"><a class="header-anchor" href="#后记">¶</a>后记</h3>
<p>向日葵也是一款优秀的国产良心软件啊，👍</p>
]]></content>
      <categories>
        <category>随笔</category>
      </categories>
      <tags>
        <tag>协议</tag>
      </tags>
  </entry>
  <entry>
    <title>ZeroTier创建Moon节点</title>
    <url>/2020/03/16/ZeroTier%E5%88%9B%E5%BB%BAMoon%E8%8A%82%E7%82%B9/</url>
    <content><![CDATA[<h3 id="前言"><a class="header-anchor" href="#前言">¶</a>前言</h3>
<p>折腾过内网穿透的玩家，ngrok、frp 都应该不陌生了，自己搭也好，用别人提供的免费服务也好，配置过程都显得有些繁琐。</p>
<p>有幸了解到 ZeroTier 的存在，使用起来真是非常方便，可以很轻松的将自己的电子设备加入同一个局域网，但由于其根服务器在国外，导致前期建立链接时访问速度较慢，好在 ZeroTier 也提供了加速方法，就是创建自己的根服务器，也就是 Moon 节点。</p>
<a id="more"></a>
<h3 id="ZeroTier"><a class="header-anchor" href="#ZeroTier">¶</a>ZeroTier</h3>
<p><a href="https://www.zerotier.com/manual/" target="_blank" rel="noopener">ZeroTier 用户手册</a></p>
<blockquote>
<p>ZeroTier is a smart Ethernet switch for planet Earth.</p>
<p>It’s a distributed network hypervisor built atop a cryptographically secure global peer to peer network. It provides advanced network virtualization and management capabilities on par with an enterprise SDN switch, but across both local and wide area networks and connecting almost any kind of app or device.</p>
</blockquote>
<p>大白话：ZeroTier 组建了一个虚拟局域网。</p>
<h3 id="创建-Moon-节点"><a class="header-anchor" href="#创建-Moon-节点">¶</a>创建 Moon 节点</h3>
<p>官方指引：<a href="https://www.zerotier.com/manual/#4_4" target="_blank" rel="noopener"><strong>4.4. Creating Your Own Roots (a.k.a. Moons)</strong></a></p>
<h4 id="前提"><a class="header-anchor" href="#前提">¶</a>前提</h4>
<blockquote>
<p>The first step in creating a moon is to deploy a set of root servers. In most cases we recommend two. These are regular ZeroTier nodes, but ones that are always on and have static (physical) IP addresses. These static IPs could be global Internet IPs or physical intranet IPs that are only reachable internally. In the latter case your moon’s roots won’t work outside your office, but that doesn’t matter. Roaming nodes will just use planetary roots instead.</p>
</blockquote>
<p>按照官方的意思，我们得有一个云服务器（常开且有固定的公网 IP），例如，我就有一台腾讯云的云服务器，这就符合条件了，我用的操作系统是 <code>CentOS 7.6 64位</code> 。</p>
<img data-src="/2020/03/16/ZeroTier%E5%88%9B%E5%BB%BAMoon%E8%8A%82%E7%82%B9/2020-03-16-16-26-37.png" class="">
<h4 id="配置-Moon-节点（Linux）"><a class="header-anchor" href="#配置-Moon-节点（Linux）">¶</a>配置 Moon 节点（Linux）</h4>
<p>插播广告：用宝塔面板进行以下操作，简单高效，没开玩笑。ennnnnn，话说在后记中，有更详细的广告。</p>
<ol>
<li>登录云服务器，安装 ZeroTier，官方提供了简便的命令</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -s https://install.zerotier.com | sudo bash</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>使用 <code>zerotier-idtool</code> 生成 Moon 配置文件</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/lib/zerotier-one</span><br><span class="line">sudo zerotier-idtool initmoon identity.public &gt; moon.json</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>编辑 moon.json，你可以用 vim 或其他方式，在 <code>stableEndpoints</code> 里添加你云服务器的公网 IP，例如 <code>119.29.29.29</code> ，端口号默认为 <code>9993</code></li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim moon.json</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"id"</span>: <span class="string">"deadbeef00"</span>,</span><br><span class="line">  <span class="string">"objtype"</span>: <span class="string">"world"</span>,</span><br><span class="line">  <span class="string">"roots"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"identity"</span>: <span class="string">"deadbeef00:0:34031483094..."</span>,</span><br><span class="line">      <span class="string">"stableEndpoints"</span>: []</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"signingKey"</span>: <span class="string">"b324d84cec708d1b51d5ac03e75afba501a12e2124705ec34a614bf8f9b2c800f44d9824ad3ab2e3da1ac52ecb39ac052ce3f54e58d8944b52632eb6d671d0e0"</span>,</span><br><span class="line">  <span class="string">"signingKey_SECRET"</span>: <span class="string">"ffc5dd0b2baf1c9b220d1c9cb39633f9e2151cf350a6d0e67c913f8952bafaf3671d2226388e1406e7670dc645851bf7d3643da701fd4599fedb9914c3918db3"</span>,</span><br><span class="line">  <span class="string">"updatesMustBeSignedBy"</span>: <span class="string">"b324d84cec708d1b51d5ac03e75afba501a12e2124705ec34a614bf8f9b2c800f44d9824ad3ab2e3da1ac52ecb39ac052ce3f54e58d8944b52632eb6d671d0e0"</span>,</span><br><span class="line">  <span class="string">"worldType"</span>: <span class="string">"moon"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="string">"stableEndpoints"</span>: [ <span class="string">"119.29.29.29/9993"</span> ]</span><br></pre></td></tr></table></figure>
<ol>
<li>生成 Moon 文件，执行命令后,会在 <code>/var/lib/zerotier-one</code> 目录下生成一个 0 开头的 <code>.moon</code> 的文件，例如 <code>000000096a34c024.moon</code></li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo zerotier-idtool genmoon moon.json</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>创建 <code>moons.d</code> 文件夹，并将 <code>.moon</code> 文件移入该文件夹内</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir moons.d</span><br><span class="line">mv 000000096a34c024.moon moons.d/</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>重启 <code>zerotier-one</code> 服务，或者直接重启云服务器，就完成配置了</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">service zerotier-one restart</span><br></pre></td></tr></table></figure>
<h3 id="使用-Moon-节点（Win-10-）"><a class="header-anchor" href="#使用-Moon-节点（Win-10-）">¶</a>使用 Moon 节点（Win 10 ）</h3>
<h4 id="配置-Moon-节点"><a class="header-anchor" href="#配置-Moon-节点">¶</a>配置 Moon 节点</h4>
<ol>
<li>将云服务器中生成的 <code>.moon</code> 文件下载出来，例如用宝塔面板进行下载</li>
</ol>
<img data-src="/2020/03/16/ZeroTier%E5%88%9B%E5%BB%BAMoon%E8%8A%82%E7%82%B9/2020-03-16-17-17-37.png" class="">
<ol start="2">
<li>进入 <code>C:\ProgramData\ZeroTier\One\</code> 目录，同样创建 <code>moons.d</code> 文件夹，并将 <code>.moon</code> 文件移入该文件夹内</li>
</ol>
<img data-src="/2020/03/16/ZeroTier%E5%88%9B%E5%BB%BAMoon%E8%8A%82%E7%82%B9/2020-03-16-16-54-16.png" class="">
<ol start="3">
<li>打开任务管理器，重启 <code>ZeroTierOneService</code> 服务</li>
</ol>
<img data-src="/2020/03/16/ZeroTier%E5%88%9B%E5%BB%BAMoon%E8%8A%82%E7%82%B9/2020-03-16-16-56-20.png" class="">
<h4 id="测试-Moon-节点"><a class="header-anchor" href="#测试-Moon-节点">¶</a>测试 Moon 节点</h4>
<p>用管理员身份启动 CMD 或 Powershell，执行命令，如何有出现你的 Moon 节点，就成功了。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">zerotier-cli listpeers</span><br></pre></td></tr></table></figure>
<img data-src="/2020/03/16/ZeroTier%E5%88%9B%E5%BB%BAMoon%E8%8A%82%E7%82%B9/2020-03-16-17-14-39.png" class="">
<h3 id="后记"><a class="header-anchor" href="#后记">¶</a>后记</h3>
<p>此文参考了官方用户手册，以及知乎 Doitky 的文章——<a href="https://zhuanlan.zhihu.com/p/96137545" target="_blank" rel="noopener">云服务器配置 ZeroTier one Moon 节点</a></p>
<p>另外，推广一下 <a href="https://www.bt.cn/" target="_blank" rel="noopener">宝塔面板</a></p>
<blockquote>
<p>宝塔 Linux 面板是提升运维效率的服务器管理软件，支持一键 LAMP/LNMP/集群/监控/网站/FTP/数据库/JAVA 等 100 多项服务器管理功能。</p>
<p>有 20 个人的专业团队研发及维护，经过 200 多个版本的迭代，功能全，少出错且足够安全，已获得全球百万用户认可安装。运维要高效，装宝塔。</p>
<p>宝塔服务器面板，一键全能部署及管理，送你 3188 元礼包，<a href="https://www.bt.cn/?invite_code=MV9kaG5idHQ=" target="_blank" rel="noopener"><strong>点我领取</strong></a></p>
</blockquote>
<p>没注册过的朋友，点击上面的链接注册，你有礼包，我有返利，何乐而不为呢？</p>
]]></content>
      <categories>
        <category>教程</category>
      </categories>
      <tags>
        <tag>ZeroTier</tag>
        <tag>Moon</tag>
        <tag>内网穿透</tag>
      </tags>
  </entry>
  <entry>
    <title>用微信发送视频文件</title>
    <url>/2020/03/15/%E7%94%A8%E5%BE%AE%E4%BF%A1%E5%8F%91%E9%80%81%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6/</url>
    <content><![CDATA[<h3 id="前言"><a class="header-anchor" href="#前言">¶</a>前言</h3>
<p>近日有不止一个朋友，用微信发送的视频或者大文件的时候，被微信无情拒绝，问我何解。</p>
<p>其实百度就有一堆答案，文件或视频太大就压缩，这里就写写用 <strong>格式工厂</strong> 来压缩视频吧。</p>
<a id="more"></a>
<h3 id="格式工厂"><a class="header-anchor" href="#格式工厂">¶</a>格式工厂</h3>
<p>官方定位是一款免费多功能的多媒体文件转换工具。</p>
<p><a href="http://down.pcgeshi.com/FormatFactory_setup.exe" target="_blank" rel="noopener">下载链接</a>： <a href="http://down.pcgeshi.com/FormatFactory_setup.exe" target="_blank" rel="noopener">http://down.pcgeshi.com/FormatFactory_setup.exe</a></p>
<h3 id="微信限制"><a class="header-anchor" href="#微信限制">¶</a>微信限制</h3>
<p>微信对于文件和视频有如下的大小限制：</p>
<img data-src="/2020/03/15/%E7%94%A8%E5%BE%AE%E4%BF%A1%E5%8F%91%E9%80%81%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6/2020-03-15-21-41-57.png" class="">
<img data-src="/2020/03/15/%E7%94%A8%E5%BE%AE%E4%BF%A1%E5%8F%91%E9%80%81%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6/2020-03-15-21-42-35.png" class="">
<p>你问为什么有这种限制，或者为什么限制到这么小，别问，问就是企业流量贼贵。</p>
<h3 id="使用方法"><a class="header-anchor" href="#使用方法">¶</a>使用方法</h3>
<ol>
<li>下载安装好后，我们打开软件，进入主界面，点击按钮</li>
</ol>
<img data-src="/2020/03/15/%E7%94%A8%E5%BE%AE%E4%BF%A1%E5%8F%91%E9%80%81%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6/2020-03-15-22-32-11.png" class="">
<ol start="2">
<li>点击输出配置</li>
</ol>
<img data-src="/2020/03/15/%E7%94%A8%E5%BE%AE%E4%BF%A1%E5%8F%91%E9%80%81%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6/2020-03-15-22-33-46.png" class="">
<ol start="3">
<li>选择自定义</li>
</ol>
<img data-src="/2020/03/15/%E7%94%A8%E5%BE%AE%E4%BF%A1%E5%8F%91%E9%80%81%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6/2020-03-15-22-35-23.png" class="">
<ol start="4">
<li>在大小限制里，选择 25 MB</li>
</ol>
<img data-src="/2020/03/15/%E7%94%A8%E5%BE%AE%E4%BF%A1%E5%8F%91%E9%80%81%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6/2020-03-15-22-35-58.png" class="">
<ol start="5">
<li>其他不用改，点击确定</li>
</ol>
<img data-src="/2020/03/15/%E7%94%A8%E5%BE%AE%E4%BF%A1%E5%8F%91%E9%80%81%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6/2020-03-15-22-36-30.png" class="">
<ol start="6">
<li>点击添加文件，或者直接将文件拖入空白区域</li>
</ol>
<img data-src="/2020/03/15/%E7%94%A8%E5%BE%AE%E4%BF%A1%E5%8F%91%E9%80%81%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6/2020-03-15-22-37-30.png" class="">
<ol start="7">
<li>添加好后，点击确定</li>
</ol>
<img data-src="/2020/03/15/%E7%94%A8%E5%BE%AE%E4%BF%A1%E5%8F%91%E9%80%81%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6/2020-03-15-22-38-08.png" class="">
<ol start="8">
<li>在主界面可以看到该任务，点击开始</li>
</ol>
<img data-src="/2020/03/15/%E7%94%A8%E5%BE%AE%E4%BF%A1%E5%8F%91%E9%80%81%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6/2020-03-15-22-38-40.png" class="">
<ol start="9">
<li>任务完成后，我们点击进入输出文件夹</li>
</ol>
<img data-src="/2020/03/15/%E7%94%A8%E5%BE%AE%E4%BF%A1%E5%8F%91%E9%80%81%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6/2020-03-15-22-39-30.png" class="">
<ol start="10">
<li>这里可以看到，视频文件已经被压缩到 25 MB 以内了</li>
</ol>
<img data-src="/2020/03/15/%E7%94%A8%E5%BE%AE%E4%BF%A1%E5%8F%91%E9%80%81%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6/2020-03-15-22-40-44.png" class="">
<h3 id="后记"><a class="header-anchor" href="#后记">¶</a>后记</h3>
<p>格式工厂真是一款国产良心软件，免费无广告不说，连个捐赠方式都没有，这让我设置打赏的这个操作很是汗颜。</p>
]]></content>
      <categories>
        <category>教程</category>
      </categories>
      <tags>
        <tag>软件</tag>
      </tags>
  </entry>
  <entry>
    <title>算法小结之动态规划</title>
    <url>/2020/03/12/%E7%AE%97%E6%B3%95%E5%B0%8F%E7%BB%93%E4%B9%8B%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/</url>
    <content><![CDATA[<h3 id="前言"><a class="header-anchor" href="#前言">¶</a>前言</h3>
<p>在上篇讨论递归的文章中，最后留了一道八皇后的问题，我们很自然的可以想到一种思路：顺着棋盘的每一行或每一列，我们找到一个可以放置皇后的位置，连续找到 8 个位置就是一组解。</p>
<p>但和之前的三道递归问题有着明显的不同，每一次放置的棋子，不仅依赖于之前放置的棋子，同时也会影响剩下来的棋子，而且每次可以放置的位置并不都唯一。</p>
<a id="more"></a>
<h3 id="八皇后"><a class="header-anchor" href="#八皇后">¶</a>八皇后</h3>
<h4 id="问题描述"><a class="header-anchor" href="#问题描述">¶</a>问题描述</h4>
<blockquote>
<p>在 8×8 格的国际象棋上摆放八个皇后，使其不能互相攻击，即任意两个皇后都不能处于同一行、同一列或同一斜线上，问有多少种摆法。</p>
</blockquote>
<img data-src="/2020/03/12/%E7%AE%97%E6%B3%95%E5%B0%8F%E7%BB%93%E4%B9%8B%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/2020-03-13-15-28-35.png" class="">
<h4 id="解题思路"><a class="header-anchor" href="#解题思路">¶</a>解题思路</h4>
<p>按照前言中的思路，定义棋盘 <code>bool[,] chessboard</code> ，我们尝试一下：</p>
<ol>
<li>
<p>先定义一个方法 <code>bool SetQueens(bool[,] chessboard, int row)</code>， 这个方法表示在第 <code>row</code> 行，放置一个皇后，如果找不到可以放置皇后的位置，则方法返回 <code>False</code></p>
</li>
<li>
<p>对于每一行而言，每一个格子都需要尝试放置皇后，我们再定义一个方法 <code>bool CheckValid(bool[,] chessboard, int row, int col)</code> 用来判断在 <code>row</code> 行 <code>col</code> 列放置的皇后是否合法</p>
</li>
<li>
<p>如果找到一个合法位置，那么很显然我们要做的事情就是在下一行继续尝试放置皇后，同时，因为我们是在每一行的所有格子都要做一遍测试，所以在这一行的下一次尝试之前，我们需要取回这一次在这一行放置的棋子</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> col = <span class="number">0</span>; col &lt; chessboard.GetLength(<span class="number">1</span>); col++)</span><br><span class="line">&#123;</span><br><span class="line">    chessboard[row, col] = <span class="literal">true</span>;<span class="comment">//放置皇后</span></span><br><span class="line">    <span class="keyword">if</span> (CheckValid(chessboard, row, col))</span><br><span class="line">    &#123;</span><br><span class="line">        SetQueens(chessboard, row + <span class="number">1</span>);<span class="comment">//放置合法，到下一行放置皇后</span></span><br><span class="line">    &#125;</span><br><span class="line">    chessboard[row, col] = <span class="literal">false</span>;<span class="comment">//取回皇后，避免干扰同一行的下一次尝试</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>不停的尝试下一行，直到放完所有行的时候，我们就得到了一个可行的解法</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (row == chessboard.GetLength(<span class="number">0</span>))</span><br><span class="line">&#123;</span><br><span class="line">    Result.Add((<span class="keyword">bool</span>[,])chessboard.Clone());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>整合一下，<code>bool SetQueens(bool[,] chessboard, int row)</code> 的方法体就是</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SetQueens</span>(<span class="params"><span class="keyword">bool</span>[,] chessboard, <span class="keyword">int</span> row = <span class="number">0</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (row == chessboard.GetLength(<span class="number">0</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//到这里，chessboard的状态就是一组可行解</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> col = <span class="number">0</span>; col &lt; chessboard.GetLength(<span class="number">1</span>); col++)</span><br><span class="line">    &#123;</span><br><span class="line">        chessboard[row, col] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (CheckValid(chessboard, row, col))</span><br><span class="line">        &#123;</span><br><span class="line">            SetQueens(chessboard, row + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        chessboard[row, col] = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当然，之前我们定义了 <code>bool CheckValid(bool[,] chessboard, int row, int col)</code>，根据规则很容易理解就是横竖撇捺上不能有其他棋子。</p>
<ul>
<li>横：由于我们是一行一行放置的，所以横一定是唯一的，就不用判断了；</li>
<li>竖：把这一列遍历一次，做判断；</li>
<li>撇：斜率为 1 且经过 <code>(row, col)</code> 这个点的直线，在正方形内的整数坐标，做判断；</li>
<li>捺：斜率为 -1 且经过 <code>(row, col)</code> 这个点的直线，在正方形内的整数坐标，做判断；</li>
</ul>
<p>根据这个思路，很容易写出方法体了：</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">CheckValid</span>(<span class="params"><span class="keyword">bool</span>[,] chessboard, <span class="keyword">int</span> row, <span class="keyword">int</span> col</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j; i &lt; chessboard.GetLength(<span class="number">0</span>); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (i != row &amp;&amp; chessboard[i, col])<span class="comment">//竖</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        j = i + col - row;<span class="comment">//撇：斜率为1</span></span><br><span class="line">        <span class="keyword">if</span> (j &gt;= <span class="number">0</span> &amp;&amp; j &lt; chessboard.GetLength(<span class="number">1</span>) &amp;&amp; j != col &amp;&amp; chessboard[i, j])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        j = col + row - i;<span class="comment">//捺：斜率为-1</span></span><br><span class="line">        <span class="keyword">if</span> (j &gt;= <span class="number">0</span> &amp;&amp; j &lt; chessboard.GetLength(<span class="number">1</span>) &amp;&amp; j != col &amp;&amp; chessboard[i, j])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="问题小结"><a class="header-anchor" href="#问题小结">¶</a>问题小结</h4>
<p>代码：<a href="https://github.com/htlsmile/HT.Algorithm" target="_blank" rel="noopener">HT.Algorithm</a>的 EightQueens</p>
<p>在这里不考虑对称的问题，八皇后有 92 组解。</p>
<p>八皇后这个问题在网上很容易找到许多简短的算法，像用一维数组做记录、位运算之类的，但本质上都是需要回溯的，其他算法的精妙之处在这里按下不表。</p>
<h3 id="双蛋问题（鸡蛋掉落、鹰蛋问题）"><a class="header-anchor" href="#双蛋问题（鸡蛋掉落、鹰蛋问题）">¶</a>双蛋问题（鸡蛋掉落、鹰蛋问题）</h3>
<p>为了能够自然的引入这个问题，又写递归，又写八皇后的，都感觉有点买椟还珠了。😂</p>
<p>其实是看了李永乐老师的一个视频，<a href="https://www.ixigua.com/i6802491359077859851/" target="_blank" rel="noopener">复工复产找工作？先来看看这道面试题：双蛋问题</a>，想记录一下解答过程。</p>
<h4 id="问题描述-v2"><a class="header-anchor" href="#问题描述-v2">¶</a>问题描述</h4>
<p>问题大意：蛋在某层楼以下扔都不会碎，有 <code>T</code> 层楼，<code>N</code> 个蛋，在运气最差的情况下，找到临界楼层需至少要 <code>M</code> 次，求 <code>M</code> 的值。</p>
<p>定义 <code>M(T,N)</code> 表示这个答案。</p>
<p>视频中 11 分钟的表格我照抄一份：</p>
<table>
<thead>
<tr>
<th>T\N</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>4</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>5</td>
<td>5</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>6</td>
<td>6</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>7</td>
<td>7</td>
<td>4</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>8</td>
<td>8</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>9</td>
<td>9</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
</tr>
</tbody>
</table>
<img data-src="/2020/03/12/%E7%AE%97%E6%B3%95%E5%B0%8F%E7%BB%93%E4%B9%8B%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/2020-03-14-19-54-00.png" class="">
<h4 id="解题思路-v2"><a class="header-anchor" href="#解题思路-v2">¶</a>解题思路</h4>
<p>在 <code>T</code> 层楼中选择第 <code>k</code> 层扔蛋：</p>
<ol>
<li>如果碎了，在 <code>(1, k - 1)</code> 之间，找出临界楼层还需要 <code>M(k - 1, N - 1)</code> 次</li>
<li>如果没碎，在 <code>(k, T)</code> 之间，找出临界楼层还需要 <code>M(T - k, N)</code> 次</li>
</ol>
<p>考虑最坏情况，在 <code>k</code> 层开始扔，两种情况需要取次数较多的一种，加上在第 <code>k</code> 层的一次，即</p>
<p>M<sub>k</sub>(T, N) = Max{ M(k - 1, N - 1), M(T - k, N) } + 1</p>
<p>那么，对于 k 而言，可以是 1 到 T 层中的任意一层，所以对应 M 的值有以下选择</p>
<table>
<thead>
<tr>
<th>k</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>…</th>
<th>T</th>
</tr>
</thead>
<tbody>
<tr>
<td>M</td>
<td>M<sub>1</sub></td>
<td>M<sub>2</sub></td>
<td>M<sub>3</sub></td>
<td>…</td>
<td>M<sub>T</sub></td>
</tr>
</tbody>
</table>
<p>根据题意，我们所求的 M，就是在 k 取[1,T]之间所对应的[M1,MT]中的最小值，即</p>
<p>M(T, N) = Min{ M<sub>1</sub>, M<sub>2</sub>, M<sub>3</sub>, …, M<sub>T</sub> }</p>
<p>那么，根据这个思路，就可以写出如下代码</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">LeastTimes</span>(<span class="params"><span class="keyword">int</span> floor, <span class="keyword">int</span> egg</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (floor &lt; <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//一层都没有，不用扔蛋</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (floor == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;<span class="comment">//只有一层楼，只需要仍一次</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (egg == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> floor;<span class="comment">//只有一个蛋，只能从一楼扔起，一个一个试</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> result = <span class="keyword">int</span>.MaxValue;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= floor; k++)<span class="comment">//选取k楼从1到T全部试一次，选取最小值</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> Mk = Math.Max(LeastTimes(k - <span class="number">1</span>, egg - <span class="number">1</span>), LeastTimes(floor - kegg)) + <span class="number">1</span>;<span class="comment">//碎没碎都有可能，运气差，取较大的</span></span><br><span class="line">            result = Math.Min(result, Mk);<span class="comment">//记录最小值</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="问题小结-v2"><a class="header-anchor" href="#问题小结-v2">¶</a>问题小结</h4>
<p>代码：<a href="https://github.com/htlsmile/HT.Algorithm" target="_blank" rel="noopener">HT.Algorithm</a>的 EggDrop</p>
<p>顺着李老师的思路，这类问题应该不难理解，虽然我在大学里始终参不透玄机。</p>
<p>同款问题在<a href="https://leetcode-cn.com/problems/super-egg-drop/" target="_blank" rel="noopener">LeetCodeCN-887. 鸡蛋掉落</a>，很显然你不能直接用上面的算法妄想去 AC，脑补一下时间复杂度，应该是过不了任何一家 OJ 的。</p>
<h3 id="鳄鱼小岛（与本文无关）"><a class="header-anchor" href="#鳄鱼小岛（与本文无关）">¶</a>鳄鱼小岛（与本文无关）</h3>
<p>李老师留的课后习题，一并写了吧。网上也有说猫捉老鼠。</p>
<h4 id="问题描述-v3"><a class="header-anchor" href="#问题描述-v3">¶</a>问题描述</h4>
<p>李永乐老师：假如有一个圆形的小岛，然后有一条鳄鱼在圆形小岛周围游弋，鳄鱼的速度是人的四倍，而且鳄鱼总是希望找到一个离人最近的位置，而这个人最开始在这个小岛的正中心，那么我问这个人该如何运动，才能够比鳄鱼先到达这个岛的边缘，从而逃离这个岛呢？</p>
<h4 id="解题思路-v3"><a class="header-anchor" href="#解题思路-v3">¶</a>解题思路</h4>
<p>先做些设定，这个岛的半径为 <code>r</code> 米，人的速度为 <code>v</code> 米/秒，那么鳄鱼的速度为 <code>4v</code> 米/秒。</p>
<p>假设我就是那个被鳄鱼困在岛上的倒霉蛋，站在圆心，鳄鱼在正南方。</p>
<ol>
<li>
<p>我想往正南方跑，那么我需要 <code>r/v</code> 秒的时间才能到，鳄鱼只需要 <code>(πr)/(4v)</code> 秒，很显然鳄鱼比我快，这样跑是不行的</p>
</li>
<li>
<p>冷静想一下，根据题意，鳄鱼一定会选择劣弧，我沿着半径直线跑不行，那我始终沿着距离鳄鱼最远的点跑吧，也就是说，我需要更换我的目标点，这个点使得鳄鱼必须要再跑 <code>πr</code> 的路程</p>
</li>
<li>
<p>假设我更换目标点时，我已经跑了 <code>m</code> 米远，鳄鱼跑了 <code>n</code> 米远，我因为目的地转换而产生的圆心角为 <code>α</code> ,那么很显然，当 <code>α ≥ π/4</code> 时，我接下来要跑的路程比半径还远，鳄鱼一定比我快</p>
</li>
</ol>
<img data-src="/2020/03/12/%E7%AE%97%E6%B3%95%E5%B0%8F%E7%BB%93%E4%B9%8B%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/2020-03-15-11-11-04.png" class="" title="灵魂画师，是吧">
<ol start="4">
<li>
<p>那么，换个思路想，是否存在一个角度，这个角度可以使得我沿半径方向在逐步靠近边缘，而始终让鳄鱼需要再走 <code>πr</code> 的距离，也就是，我和圆心和鳄鱼共线在同一条直径上</p>
</li>
<li>
<p>很容易想到，在同一个圆心，半径为 <code>r/4</code> 的圆里，我是完全办得到的，因为在这个圆里，即便鳄鱼的速度是我的四倍，我跑的角速度也是大于或等于鳄鱼的角速度，使得三点共线</p>
</li>
<li>
<p>那么，在我跑到 <code>r/4</code> 处，只要沿着圆心相反的方向再跑 <code>(3r)/4</code> 的距离就可以跑到边缘，对于我而言，我所需要的时间是 <code>(3r)/(4v)</code> 秒，而鳄鱼需要 <code>(πr)/(4v)</code> 秒，显然我更快，那么我就成功逃离了</p>
</li>
</ol>
<h4 id="问题小结-v3"><a class="header-anchor" href="#问题小结-v3">¶</a>问题小结</h4>
<p>这道题，算数学问题还是算物理问题呢？</p>
<h3 id="后记"><a class="header-anchor" href="#后记">¶</a>后记</h3>
<p>用递归的方法去解决问题，代码看起来很优雅，但到了像比较复杂的动态规划里，普通递归的代码就带来肉眼可见的时空间复杂度，这往往是不可接受的。</p>
<p>对于学习理解来说，这种写法尚可，但在实际解决问题时，需要去做优化，这种优化有的是基于强大的数学功底，例如</p>
<ul>
<li>
<p>阶乘： <a href="https://sites.google.com/site/examath/research/factorials" target="_blank" rel="noopener">Exa-Math</a>，404 的话，我存了一份图片，用电脑看，<a href="../%E7%AE%97%E6%B3%95%E5%B0%8F%E7%BB%93%E4%B9%8B%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/sites.google.com_site_examath_research_factorials.png">网页截图</a></p>
</li>
<li>
<p>斐波那契数列：<a href="https://www.mathsisfun.com/numbers/fibonacci-sequence.html" target="_blank" rel="noopener">Math is fun</a></p>
</li>
</ul>
<p>有的则是记忆、剪枝等等，罢了，不说了，接着留坑吧。</p>
]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>递归</tag>
        <tag>动态规划</tag>
      </tags>
  </entry>
  <entry>
    <title>算法小结之递归</title>
    <url>/2020/03/12/%E7%AE%97%E6%B3%95%E5%B0%8F%E7%BB%93%E4%B9%8B%E9%80%92%E5%BD%92/</url>
    <content><![CDATA[<h3 id="前言"><a class="header-anchor" href="#前言">¶</a>前言</h3>
<p>初识汉诺塔，见其递归解法，舌挢不下，以为神技。</p>
<a id="more"></a>
<h3 id="概念"><a class="header-anchor" href="#概念">¶</a>概念</h3>
<p><a href="https://en.wikipedia.org/wiki/Recursion_(computer_science)" target="_blank" rel="noopener">递归(Recursion)</a> 维基百科：</p>
<blockquote>
<p>Recursion in computer science is a method of solving a problem where the solution depends on solutions to smaller instances of the same problem. Such problems can generally be solved by iteration, but this needs to identify and index the smaller instances at programming time. At the opposite, recursion solves such recursive problems by using functions that call themselves from within their own code. The approach can be applied to many types of problems, and recursion is one of the central ideas of computer science.</p>
</blockquote>
<p><a href="https://baike.baidu.com/item/%E9%80%92%E5%BD%92%E7%AE%97%E6%B3%95" target="_blank" rel="noopener">递归(Recursion)</a> 百度百科：</p>
<blockquote>
<p>递归算法（英语：recursion algorithm）在计算机科学中是指一种通过重复将问题分解为同类的子问题而解决问题的方法。递归式方法可以被用于解决很多的计算机科学问题，因此它是计算机科学中十分重要的一个概念。绝大多数编程语言支持函数的自调用，在这些语言中函数可以通过调用自身来进行递归。计算理论可以证明递归的作用可以完全取代循环，因此在很多函数编程语言（如 Scheme）中习惯用递归来实现循环。</p>
</blockquote>
<h3 id="随笔"><a class="header-anchor" href="#随笔">¶</a>随笔</h3>
<p>从代码的角度来看，递归最显著的特征就是一个递归方法会在方法体内部调用自身。</p>
<p>犹记得在学习谭浩强老师的 C 语言程序设计时，第一次见到<a href="https://baike.baidu.com/item/%E6%B1%89%E8%AF%BA%E5%A1%94/3468295" target="_blank" rel="noopener">汉诺塔</a>问题，当时苦苦思索也难以理解，甚至直接将代码背下来，当时还是太心急，忘记学习要循序渐进了。😅</p>
<p>如果对<a href="https://baike.baidu.com/item/%E6%95%B0%E5%AD%A6%E5%BD%92%E7%BA%B3%E6%B3%95" target="_blank" rel="noopener">数学归纳法</a>掌握得很熟练，那递归的概念也就很好理解了，如今递归算法写的也算是信手拈来了，对递归的学习过程也有了自己的理解，顺着以下三个问题来学习或回顾一下递归吧。</p>
<h3 id="问题一：阶乘"><a class="header-anchor" href="#问题一：阶乘">¶</a>问题一：阶乘</h3>
<blockquote>
<p>一个正整数的阶乘（factorial）是所有小于及等于该数的正整数的积，并且 0 的阶乘为 1。</p>
<p>0! = 1<br>
n! = 1 x 2 x 3 x … x (n - 1) x n , n &gt; 0</p>
</blockquote>
<p>根据阶乘的定义，结合数学归纳法的思路，来思考一个求 <code>integer</code> 阶乘的值的方法怎么写：</p>
<ol>
<li>
<p>方法声明：<code>BigInteger Factorial(BigInteger integer)</code>，下面用 <code>n</code> 代表参数 <code>integer</code></p>
</li>
<li>
<p>当 <code>n = 1</code> 时，命题成立，也就是说 <code>Factorial(1) == 1</code> ，这个很容易写</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (integer == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>假设对于任意 <code>n = m, m 为大于 1 的正整数</code> 时，命题成立，那么 <code>Factorial(m) == m!</code></p>
</li>
<li>
<p>求证 <code>n = m + 1</code> ，命题也成立，那么我们就需要证明 <code>Factorial(m + 1) == (m + 1)!</code></p>
</li>
<li>
<p>根据阶乘的定义，易得 <code>(m + 1)! = (m + 1) x m!</code></p>
</li>
<li>
<p>结合 3 和 4，也就是要证明 <code>Factorial(m + 1) == (m + 1) x Factorial(m)</code></p>
</li>
<li>
<p>借鉴数学归纳法的思路结束，不需要真的去证明，根据第 3 点的假设，我们将 <code>m = integer - 1</code> 代入上式，可得 <code>Factorial(integer) == integer x Factorial(integer - 1)</code></p>
</li>
<li>
<p>那么，对于任意大于 1 的分支也求解出来了</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(integer &gt; <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> integer * Factorial(integer - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>再补充一个 0 的阶乘为 1 的分支</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(integer == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>至此，阶乘的定义已经完全用代码表示出来了，完整的方法整合如下</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function">BigInteger <span class="title">Factorial</span>(<span class="params">BigInteger integer</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (integer == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (integer == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> integer * Factorial(integer - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>或许你发现 <code>integer == 1</code> 这个分支不写，结果也是正确的，因为 <code>Factorial(1) == 1 x Factorial(0)</code> 恰好成立，但这只是一种巧合，这也就是规定 <code>0! = 1</code> 的理由。</p>
<p>阶乘的问题到这里就结束了，从这个思考过程中可以整理出递归算法的通用思路：</p>
<ol>
<li>判断一个问题基于变量的不同，这些答案彼此关系是否独立，还是具有依赖关系？例如计算一个数的阶乘的答案是有依赖关系的，<code>4! = 4 x 3!, 3! = 3 x 2!, 2! = 2 x 1!</code></li>
<li>将这种依赖关系表达出来，<code>Factorial(integer) == integer x Factorial(integer - 1)</code></li>
<li>找到最简单的答案，<code>Factorial(1) == 1</code></li>
<li>组合起来，加上 <code>0! = 1</code> 这个定义，就是完整的阶乘递归算法了。</li>
</ol>
<h3 id="问题二：斐波那契数列"><a class="header-anchor" href="#问题二：斐波那契数列">¶</a>问题二：斐波那契数列</h3>
<blockquote>
<p>斐波那契数列的定义：一个数列的前两项均是 1，这个数列从第 3 项开始，每一项都等于前两项之和。</p>
<p>斐波那契数列：1,1,2,3,5,8,13,21…</p>
</blockquote>
<p>我们定义一个方法是求斐波那契数列第 index 项的值：<code>BigInteger Fibonacci(BigInteger index)</code></p>
<p>递归算法的思路：</p>
<ol>
<li>斐波那契数列第 <code>index</code> 项的值是依赖 <code>index - 1</code> 和 <code>index - 2</code> 项的值的，也就是<br>
<code>Fibonacci(index) == Fibonacci(index - 1) + Fibonacci(index - 2)</code></li>
<li>找到最简单的答案，根据定义，<code>Fibonacci(1) == Fibonacci(2) == 1</code></li>
</ol>
<p>那么，整合一下就是</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function">BigInteger <span class="title">Fibonacci</span>(<span class="params">BigInteger index</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index == <span class="number">1</span> || index == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Fibonacci(index - <span class="number">1</span>) + Fibonacci(index - <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="问题三：汉诺塔"><a class="header-anchor" href="#问题三：汉诺塔">¶</a>问题三：汉诺塔</h3>
<blockquote>
<p>汉诺塔（又称河内塔）问题是源于印度一个古老传说的益智玩具。大梵天创造世界的时候做了三根金刚石柱子，在一根柱子上从下往上按照大小顺序摞着 64 片黄金圆盘。大梵天命令婆罗门把圆盘从下面开始按大小顺序重新摆放在另一根柱子上。并且规定，在小圆盘上不能放大圆盘，在三根柱子之间一次只能移动一个圆盘。</p>
</blockquote>
<p>根据汉诺塔的规则，我们假设有名为 <code>A</code>，<code>B</code>，<code>C</code> 的三根柱子，其中 A 柱子上有从小到大依次摆放的 <code>n</code> 个圆盘，目标是将圆盘全部从 <code>A</code> 移动到 <code>C</code> 上，<code>B</code> 作为辅助。</p>
<img data-src="/2020/03/12/%E7%AE%97%E6%B3%95%E5%B0%8F%E7%BB%93%E4%B9%8B%E9%80%92%E5%BD%92/2020-03-13-14-48-19.png" class="">
<p>同样，我们定义一个方法来解决汉诺塔问题,<br>
<code>void Hanoi(BigInteger count, string current, string transfer, string destination)</code><br>
这个方法我们先认为，它就是将 <code>count</code> 个圆盘从 <code>current</code> 搬到 <code>destination</code>，<code>transfer</code> 作为辅助。</p>
<p>递归算法的思路：</p>
<ol>
<li>将 <code>n</code> 个圆盘看作两部分，一部分是下面最大的 <code>1</code> 个圆盘，另一部分是除最大以外的 <code>n-1</code> 个圆盘，那么按照两个圆盘的玩法，我们很容易有这样的思路：先将 <code>n-1</code> 个圆盘从 <code>A</code> 搬到 <code>B</code>，<code>C</code> 为辅助；再将最大的圆盘从 <code>A</code> 搬到 <code>C</code>，<code>B</code> 为辅助；最后将 <code>n-1</code> 个圆盘从 <code>B</code> 搬到 <code>C</code>。根据上面的方法定义，用代码来翻译一下：<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line">Hanoi(n - <span class="number">1</span>, A, C, B);</span><br><span class="line">Hanoi(<span class="number">1</span>, A, B, C);</span><br><span class="line">Hanoi(n - <span class="number">1</span>, B, A, C);</span><br></pre></td></tr></table></figure>
</li>
<li>找到最简单的答案，当然是 <code>1</code> 个圆盘的情况，直接从 <code>A</code> 搬到 <code>C</code><figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (count == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">$"Move disc from <span class="subst">&#123;A&#125;</span> to <span class="subst">&#123;C&#125;</span>"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>那么，求解 <code>n</code> 个圆盘的调用就是 <code>Hanoi(n, &quot;A&quot;, &quot;B&quot;, &quot;C&quot;)</code> ，整合一下就是</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Hanoi</span>(<span class="params">BigInteger count, <span class="keyword">string</span> current, <span class="keyword">string</span> transfer, <span class="keyword">string</span> destination</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (count == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$"Move disc from <span class="subst">&#123;current&#125;</span> to <span class="subst">&#123;destination&#125;</span>"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        Hanoi(count - <span class="number">1</span>, current, destination, transfer);</span><br><span class="line">        Hanoi(<span class="number">1</span>, current, transfer, destination);</span><br><span class="line">        Hanoi(count - <span class="number">1</span>, transfer, current, destination);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="思维拓展：八皇后"><a class="header-anchor" href="#思维拓展：八皇后">¶</a>思维拓展：八皇后</h3>
<blockquote>
<p>在 8×8 格的国际象棋上摆放八个皇后，使其不能互相攻击，即任意两个皇后都不能处于同一行、同一列或同一斜线上，问有多少种摆法。</p>
</blockquote>
<img data-src="/2020/03/12/%E7%AE%97%E6%B3%95%E5%B0%8F%E7%BB%93%E4%B9%8B%E9%80%92%E5%BD%92/2020-03-13-15-28-35.png" class="">
<p>这个问题的思路在下一篇动态规划中再做讨论。</p>
<h3 id="后记"><a class="header-anchor" href="#后记">¶</a>后记</h3>
<p>三个递归问题的源码在<a href="https://github.com/htlsmile/HT.Algorithm" target="_blank" rel="noopener">HT.Algorithm</a>的 Recursion 项目中。</p>
<p>复杂的的问题通过递归算法能够写出很符合思维的优雅代码，不过通常这种优雅伴随着难以接受的时间复杂度和空间复杂度，这就涉及到更多有意思的知识了，大家可以去<a href="https://leetcode-cn.com/explore/featured/card/recursion-i/" target="_blank" rel="noopener">LeetCodeCN-递归</a>中自行探索。当然这些问题也能够用非递归的方式去解决，例如汉诺塔的非递归解法，有兴趣的朋友自行百度。</p>
]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>递归</tag>
      </tags>
  </entry>
  <entry>
    <title>数独的识别与求解</title>
    <url>/2020/03/08/%E6%95%B0%E7%8B%AC%E7%9A%84%E8%AF%86%E5%88%AB%E4%B8%8E%E6%B1%82%E8%A7%A3/</url>
    <content><![CDATA[<h3 id="前言"><a class="header-anchor" href="#前言">¶</a>前言</h3>
<p>🤐 疫情在家宅太久了，闷得慌，2020 年 2 月 26 日，<a href="https://www.ithome.com/0/474/867.htm" target="_blank" rel="noopener">微软数独正式上架苹果 App Store</a>，就下载玩了起来，游戏本身制作非常精良，只是内置了广告，付费去广告的价格有点高，15 元/月或 73 元/年，买不起，还是将就一下吧。玩得久了后，又觉得有点无聊和费劲了，索性来写个程序解数独吧。</p>
<a id="more"></a>
<img data-src="/2020/03/08/%E6%95%B0%E7%8B%AC%E7%9A%84%E8%AF%86%E5%88%AB%E4%B8%8E%E6%B1%82%E8%A7%A3/2020-03-08-20-49-54.png" class="" title="微软数独">
<p>Tip：数独求解用的是<a href="https://baike.baidu.com/item/%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2/5224976" target="_blank" rel="noopener">DFS</a>，图像识别用的是<a href="https://github.com/shimat/opencvsharp" target="_blank" rel="noopener">OpenCvSharp</a>，数字识别用的是<a href="https://github.com/tesseract-ocr/tesseract" target="_blank" rel="noopener">Tesseract OCR</a>。</p>
<p>😅 话说好久不练算法了，还得去百度查一下才敢说自己写的是 DFS。</p>
<h3 id="数独求解"><a class="header-anchor" href="#数独求解">¶</a>数独求解</h3>
<p>从最简单的部分讲起吧，是的，求解才是最简单的部分。首先用 WPF 写个简单的数独游戏界面出来，数独的格子就用 Button 吧，点击再弹出一个数字选择的窗体，当然也支持点击后直接用按键输入。</p>
<img data-src="/2020/03/08/%E6%95%B0%E7%8B%AC%E7%9A%84%E8%AF%86%E5%88%AB%E4%B8%8E%E6%B1%82%E8%A7%A3/2020-03-09-11-59-12.png" class="" title="游戏界面">
<p>随便输入一些数字，会以黑色展示，然后点击 <code>Solve</code> 按钮，就可以求解，当然，你可以连续点击 <code>Solve</code>，获取随机答案。</p>
<img data-src="/2020/03/08/%E6%95%B0%E7%8B%AC%E7%9A%84%E8%AF%86%E5%88%AB%E4%B8%8E%E6%B1%82%E8%A7%A3/2020-03-09-12-02-39.png" class="" title="解1">
<img data-src="/2020/03/08/%E6%95%B0%E7%8B%AC%E7%9A%84%E8%AF%86%E5%88%AB%E4%B8%8E%E6%B1%82%E8%A7%A3/2020-03-09-12-02-58.png" class="" title="解2">
<p>求解的算法倒是很好写，很久没碰算法了，也是一遍写过，不需要调试。</p>
<p>求解方法<code>Solve</code>的代码如下所示：</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> Random random = <span class="keyword">new</span> Random();</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="keyword">int</span>[] nums = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">Solve</span>(<span class="params"><span class="keyword">int</span>[,] data, <span class="keyword">int</span> i = <span class="number">0</span>, <span class="keyword">int</span> j = <span class="number">0</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    i += j / <span class="number">9</span>;</span><br><span class="line">    j %= <span class="number">9</span>;</span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">9</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (data[i, j] == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> r = random.Next(<span class="number">100</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">0</span>; v &lt; nums.Length; v++)</span><br><span class="line">        &#123;</span><br><span class="line">            data[i, j] = nums[(r + v) % nums.Length];</span><br><span class="line">            <span class="keyword">if</span> (CheckValue(data, i, j) &amp;&amp; Solve(data, i, j + <span class="number">1</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        data[i, j] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Solve(data, i, j + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>核心求解方法 <code>Solve</code>，数独的数据通过二维数组<code>int[,] data</code>保存，0 代表没有填充数字。算法简单的应该不需要讲解了，<code>CheckValue</code>方法就是判断填入的数字是否满足数独的规则。</p>
<h3 id="数独识别"><a class="header-anchor" href="#数独识别">¶</a>数独识别</h3>
<p>最麻烦的部分来了，求解半小时，识别一整天，一开始没意识到这么麻烦，<a href="https://baike.baidu.com/item/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89" target="_blank" rel="noopener">计算机视觉(Computer Vision)</a>之前也只是简单了解，从没有实际应用过，这次也算是实战了一回。</p>
<p>为什么要做识别呢？理由很简单，数独游戏可能是来自手机 APP、网页或程序等等，获取这些数据，最通用的方式，还是先截图，然后再从图片中识别。</p>
<p>既然是截图，索性就直接全屏截图，然后识别截图中的数独，识别部分的思路是按照 OpenCV 的惯用思路去处理，首先获取 <code>MAT</code>，然后依次调用<code>CvtColor</code>、<code>GaussianBlur</code>、<code>Canny</code>方法进行灰化、降噪、边缘检测处理。</p>
<img data-src="/2020/03/08/%E6%95%B0%E7%8B%AC%E7%9A%84%E8%AF%86%E5%88%AB%E4%B8%8E%E6%B1%82%E8%A7%A3/2020-03-09-17-17-35.png" class="" title="全屏截图">
<img data-src="/2020/03/08/%E6%95%B0%E7%8B%AC%E7%9A%84%E8%AF%86%E5%88%AB%E4%B8%8E%E6%B1%82%E8%A7%A3/2020-03-09-17-19-23.png" class="" title="CvtColor灰化">
<img data-src="/2020/03/08/%E6%95%B0%E7%8B%AC%E7%9A%84%E8%AF%86%E5%88%AB%E4%B8%8E%E6%B1%82%E8%A7%A3/2020-03-09-17-19-55.png" class="" title="GaussianBlur降噪">
<img data-src="/2020/03/08/%E6%95%B0%E7%8B%AC%E7%9A%84%E8%AF%86%E5%88%AB%E4%B8%8E%E6%B1%82%E8%A7%A3/2020-03-09-17-20-24.png" class="" title="Canny边缘检测">
<p>之后的思路便是自由发挥了，我先假定屏幕上只有一个数独：</p>
<ol>
<li>通过 <code>FindContours</code> 方法提取图像的所有轮廓；</li>
<li>然后遍历轮廓，记录这些轮廓作为其他轮廓的 <code>Parent</code> 的出现次数；</li>
<li>找到出现次数不小于 9 次（图示里用红色矩形标记）且高度（宽度或面积也行）最大的一个轮廓，应该就是数独的轮廓；</li>
</ol>
<img data-src="/2020/03/08/%E6%95%B0%E7%8B%AC%E7%9A%84%E8%AF%86%E5%88%AB%E4%B8%8E%E6%B1%82%E8%A7%A3/2020-03-09-17-26-24.png" class="" title="3-出现不小于9次的轮廓">
<ol start="4">
<li>截取数独轮廓，从全屏截图中剔除数独以外的图像内容；</li>
</ol>
<img data-src="/2020/03/08/%E6%95%B0%E7%8B%AC%E7%9A%84%E8%AF%86%E5%88%AB%E4%B8%8E%E6%B1%82%E8%A7%A3/2020-03-09-17-27-23.png" class="" title="4-截取数独轮廓">
<ol start="5">
<li>再次通过 <code>FindContours</code> 方法提取数独图像的所有轮廓；</li>
<li>遍历轮廓，通过 <code>BoundingRect</code> 方法定位矩形边界，这是为了找到数独图像中的数字；</li>
<li>判断矩形边界的高度（毕竟数字的字符宽度不确定，但高度至少是一致的），高度在整个数独轮廓的 1/18 和 1/12 之间的，基本可以判断是数字；</li>
</ol>
<img data-src="/2020/03/08/%E6%95%B0%E7%8B%AC%E7%9A%84%E8%AF%86%E5%88%AB%E4%B8%8E%E6%B1%82%E8%A7%A3/2020-03-09-17-28-10.png" class="" title="7-定位符合要求的数字">
<ol start="8">
<li>计算矩形的所在坐标，并调用 <code>Tesseract</code> 进行数字识别。</li>
</ol>
<img data-src="/2020/03/08/%E6%95%B0%E7%8B%AC%E7%9A%84%E8%AF%86%E5%88%AB%E4%B8%8E%E6%B1%82%E8%A7%A3/2020-03-09-18-18-06.png" class="" title="8-识别结果_黑色数字">
<p><code>setNumber</code> 的三个参数，分别是行、列、值，用于将识别出来的数据进行输出，识别部分的代码如下所示：</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">OCR</span>(<span class="params">Action&lt;<span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>&gt; setNumber, <span class="keyword">string</span> fileName = tempFilename</span>)</span> =&gt; <span class="keyword">await</span> Task.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> src = <span class="keyword">new</span> Mat(fileName);</span><br><span class="line">    <span class="keyword">var</span> tmp = src.Clone();</span><br><span class="line">    Cv2.CvtColor(src, tmp, ColorConversionCodes.RGB2GRAY);</span><br><span class="line">    Cv2.GaussianBlur(tmp, tmp, <span class="keyword">new</span> Size(<span class="number">3</span>, <span class="number">3</span>), <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    Cv2.Canny(tmp, tmp, <span class="number">10</span>, <span class="number">255</span>);</span><br><span class="line">    Cv2.FindContours(tmp, <span class="keyword">out</span> Point[][] contours, <span class="keyword">out</span> HierarchyIndex[] hierarchy, RetrievalModes.Tree, ContourApproximationModes.ApproxSimple);</span><br><span class="line">    <span class="keyword">var</span> rect = <span class="keyword">new</span> Rect();</span><br><span class="line">    <span class="keyword">var</span> contourCount = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; contours.GetLength(<span class="number">0</span>); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> p = hierarchy[i].Parent;</span><br><span class="line">        <span class="keyword">if</span> (p &gt;= <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (contourCount.ContainsKey(p))</span><br><span class="line">            &#123;</span><br><span class="line">                contourCount[p]++;</span><br><span class="line">                <span class="keyword">if</span> (contourCount[p] &gt;= <span class="number">9</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">var</span> r = Cv2.BoundingRect(contours[p]);</span><br><span class="line">                    <span class="keyword">if</span> (r.Height &gt; rect.Height)</span><br><span class="line">                    &#123;</span><br><span class="line">                        rect = r;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                contourCount.Add(p, <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    tmp = <span class="keyword">new</span> Mat(tmp, rect);</span><br><span class="line">    src = <span class="keyword">new</span> Mat(src, rect);</span><br><span class="line">    Cv2.FindContours(tmp, <span class="keyword">out</span> contours, <span class="keyword">out</span> hierarchy, RetrievalModes.Tree, ContourApproximationModes.ApproxSimple);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; contours.GetLength(<span class="number">0</span>); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> r = Cv2.BoundingRect(contours[i]);</span><br><span class="line">        <span class="keyword">if</span> (r.Height &lt; (rect.Height / <span class="number">12.0</span>) &amp;&amp; r.Height &gt; (rect.Height / <span class="number">18.0</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">new</span> Mat(src, r).ImWrite(fileName))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> m = (<span class="keyword">int</span>)((r.Top + r.Height / <span class="number">2.0</span>) / (rect.Height / <span class="number">9.0</span>));</span><br><span class="line">                <span class="keyword">var</span> n = (<span class="keyword">int</span>)((r.Left + r.Width / <span class="number">2.0</span>) / (rect.Width / <span class="number">9.0</span>));</span><br><span class="line">                <span class="keyword">var</span> text = OCRSingleNumber(fileName);</span><br><span class="line">                setNumber(m, n, text);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>数独识别部分的完整代码在<code>SudokuCV.cs</code>文件里。</p>
<h3 id="识别效果"><a class="header-anchor" href="#识别效果">¶</a>识别效果</h3>
<p>对于主色调是黑白灰之类的，识别效果尚可，像 iOS 版的微软数独，但是对于颜色丰富点的图像，识别效果就相当差了，调这个有点麻烦，还是把这个坑留着吧。</p>
<ul>
<li>效果还行的位置：iOS 微软数独、<a href="http://www.sudoku.name/index-cn.php" target="_blank" rel="noopener">http://www.sudoku.name/index-cn.php</a></li>
</ul>
<img data-src="/2020/03/08/%E6%95%B0%E7%8B%AC%E7%9A%84%E8%AF%86%E5%88%AB%E4%B8%8E%E6%B1%82%E8%A7%A3/2020-03-09-16-28-04.png" class="">
<ul>
<li>效果很差的位置：UWP 微软数独、<a href="https://www.sudoku-cn.com/" target="_blank" rel="noopener">https://www.sudoku-cn.com/</a></li>
</ul>
<h3 id="后记"><a class="header-anchor" href="#后记">¶</a>后记</h3>
<p>本项目的完整源码已存到 Github 上，<a href="https://github.com/htlsmile/HT.Sudoku" target="_blank" rel="noopener">HT.Sudoku</a></p>
<p>至于数独答案怎么自动输入，留坑，看以后啥时候又闲得慌就来填坑。</p>
<p>另外，😏 对数独求解有兴趣的 gamer，去瞧瞧下面这篇文章吧。</p>
<p><a href="http://norvig.com/sudoku.html" target="_blank" rel="noopener">Solving Every Sudoku Puzzle</a></p>
]]></content>
      <categories>
        <category>编程</category>
      </categories>
      <tags>
        <tag>OpenCV</tag>
        <tag>Tesseract</tag>
        <tag>OCR</tag>
      </tags>
  </entry>
  <entry>
    <title>AES加密</title>
    <url>/2019/12/29/AES%E5%8A%A0%E5%AF%86/</url>
    <content><![CDATA[<h3 id="代码记录"><a class="header-anchor" href="#代码记录">¶</a>代码记录</h3>
<a id="more"></a>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 基于Rijndael算法实现的AES加密类</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">Aes</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 对称算法的密钥</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="keyword">byte</span>[] Key = Convert.FromBase64String(<span class="string">"rAO85BOVE3bIh2KEjbFlQ7uVYjzD5UdHGPET2YnDxbM="</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 对称算法的初始化向量</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="keyword">byte</span>[] IV = Convert.FromBase64String(<span class="string">"fsUfF+aIEeTsp9SfmMvHkA=="</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 加密</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="plainText"&gt;</span>明文<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="encoding"&gt;</span>编码方式（默认为UTF8）<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>密文（Base64编码）<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">string</span> <span class="title">Encrypt</span>(<span class="params"><span class="keyword">string</span> plainText, Encoding encoding = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        encoding = encoding ?? Encoding.UTF8;</span><br><span class="line">        <span class="keyword">using</span> (<span class="keyword">var</span> rij = <span class="keyword">new</span> RijndaelManaged &#123; Key = Key, IV = IV, Mode = CipherMode.CBC, Padding = PaddingMode.PKCS7 &#125;)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> plainBytes = encoding.GetBytes(plainText);</span><br><span class="line">            <span class="keyword">return</span> Convert.ToBase64String(rij.CreateEncryptor().TransformFinalBlock(plainBytes, <span class="number">0</span>, plainBytes.Length));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 解密</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="cipherText"&gt;</span>密文（Base64编码）<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="encoding"&gt;</span>编码方式（默认为UTF8）<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>明文<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">string</span> <span class="title">Decrypt</span>(<span class="params"><span class="keyword">string</span> cipherText, Encoding encoding = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        encoding = encoding ?? Encoding.UTF8;</span><br><span class="line">        <span class="keyword">using</span> (<span class="keyword">var</span> rij = <span class="keyword">new</span> RijndaelManaged &#123; Key = Key, IV = IV, Mode = CipherMode.CBC, Padding = PaddingMode.PKCS7 &#125;)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> cipherBytes = Convert.FromBase64String(cipherText);</span><br><span class="line">            <span class="keyword">return</span> encoding.GetString(rij.CreateDecryptor().TransformFinalBlock(cipherBytes, <span class="number">0</span>, cipherBytes.Length));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>编程</category>
      </categories>
      <tags>
        <tag>.NET</tag>
        <tag>Framework</tag>
        <tag>Core</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker的使用</title>
    <url>/2018/04/15/Docker%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<h3 id="Docker-常用命令"><a class="header-anchor" href="#Docker-常用命令">¶</a>Docker 常用命令</h3>
<figure class="highlight docker"><table><tr><td class="code"><pre><span class="line">docker images //镜像列表</span><br><span class="line">docker ps -a //所有运行过的容器</span><br><span class="line">docker ps -l //最后运行容器</span><br><span class="line">docker export 容器id &gt; 文件  //持久化容器</span><br><span class="line">docker import 文件 //导入容器</span><br><span class="line">cat export.tar | docker import - linezero/demo-export:latest</span><br><span class="line">docker save 镜像id &gt; 文件 //持久化镜像</span><br><span class="line">docker load &lt; 文件</span><br><span class="line">docker rm 容器id //删除容器</span><br><span class="line">docker rmi 镜像id/镜像名称  //删除镜像</span><br><span class="line">docker <span class="keyword">run</span><span class="bash"> 镜像 //运行</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="Dockerfile-文本内容（项目名称为-WebDemo）"><a class="header-anchor" href="#Dockerfile-文本内容（项目名称为-WebDemo）">¶</a>Dockerfile 文本内容（项目名称为 WebDemo）</h3>
<figure class="highlight docker"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FROM</span> microsoft/aspnetcore</span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> . /webdemo</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /webdemo</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">"dotnet"</span>, <span class="string">"WebDemo.dll"</span>]</span></span><br></pre></td></tr></table></figure>
<p>webdemo 为项目所在文件夹，Dockerfile 也放入该文件夹内，WebDemo.dll 为项目文件</p>
<!-- more -->
<h3 id="重新生成项目"><a class="header-anchor" href="#重新生成项目">¶</a>重新生成项目</h3>
<ol>
<li>查看所有容器</li>
</ol>
<figure class="highlight docker"><table><tr><td class="code"><pre><span class="line">docker ps -a</span><br><span class="line"><span class="comment">#以下为示例输出</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                NAMES</span><br><span class="line">a98e451e8545        webdemo             <span class="string">"dotnet WebDemo…"</span>   <span class="number">5</span> minutes ago       Up <span class="number">5</span> minutes        <span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">80</span>-&gt;<span class="number">80</span>/tcp   webdemo</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>删除项目容器</li>
</ol>
<figure class="highlight docker"><table><tr><td class="code"><pre><span class="line">docker rm a98e</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>查看项目镜像</li>
</ol>
<figure class="highlight docker"><table><tr><td class="code"><pre><span class="line">docker images</span><br><span class="line"><span class="comment">#以下为示例输出</span></span><br><span class="line">REPOSITORY             TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">webdemo                latest              <span class="number">51656978590</span>e        <span class="number">14</span> minutes ago      <span class="number">405</span>MB</span><br><span class="line">microsoft/dotnet       latest              <span class="number">3</span>cd958947571        <span class="number">2</span> months ago        <span class="number">1.75</span>GB</span><br><span class="line">microsoft/aspnetcore   latest              <span class="number">36</span>f6b6bc707a        <span class="number">2</span> months ago        <span class="number">325</span>MB</span><br><span class="line">hello-world            latest              f2a91732366c        <span class="number">6</span> months ago        <span class="number">1.85</span>kB</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>删除项目镜像</li>
</ol>
<figure class="highlight docker"><table><tr><td class="code"><pre><span class="line">docker rmi webdemo</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>跳转到项目目录，即 CD 到 webdemo 文件夹</li>
<li>编译生成镜像</li>
</ol>
<figure class="highlight docker"><table><tr><td class="code"><pre><span class="line">docker build . -t webdemo</span><br></pre></td></tr></table></figure>
<ol start="7">
<li>后台运行 Docker 容器</li>
</ol>
<figure class="highlight docker"><table><tr><td class="code"><pre><span class="line">docker <span class="keyword">run</span><span class="bash"> --name webdemo -p 80:80 -d webdemo</span></span><br></pre></td></tr></table></figure>
<ol start="8">
<li>访问网站主页</li>
</ol>
]]></content>
      <categories>
        <category>教程</category>
      </categories>
      <tags>
        <tag>.NET</tag>
        <tag>Core</tag>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>杂项记录</title>
    <url>/2018/03/11/%E6%9D%82%E9%A1%B9%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<h3 id="前言"><a class="header-anchor" href="#前言">¶</a>前言</h3>
<p>形形色色、林林总总、各式各样、五花八门的世界。</p>
<h3 id="Emoji"><a class="header-anchor" href="#Emoji">¶</a>Emoji</h3>
<ul>
<li>
<p><a href="http://emojihomepage.com/" target="_blank" rel="noopener">Emoji Homepage</a>：可以直接复制粘贴 Emoji</p>
</li>
<li>
<p><a href="https://www.webfx.com/tools/emoji-cheat-sheet/" target="_blank" rel="noopener">EMOJI CHEAT SHEET</a>：Emoji 代码</p>
</li>
</ul>
<a id="more"></a>
<h3 id="编程"><a class="header-anchor" href="#编程">¶</a>编程</h3>
<ul>
<li>
<p><a href="https://www.wpf-tutorial.com/" target="_blank" rel="noopener">WPF 教程</a></p>
</li>
<li>
<p><a href="https://dotnet.microsoft.com/download/archives" target="_blank" rel="noopener">.NET Download Archives</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/zh-cn/dotnet/" target="_blank" rel="noopener">.NET 文档</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/zh-cn/dotnet/standard/design-guidelines/" target="_blank" rel="noopener">框架设计准则</a></p>
</li>
<li>
<p><a href="https://www.gitbook.com/" target="_blank" rel="noopener">GitBook</a></p>
</li>
</ul>
<h3 id="Blog"><a class="header-anchor" href="#Blog">¶</a>Blog</h3>
<ul>
<li>
<p><a href="http://www.ruanyifeng.com/blog/" target="_blank" rel="noopener">阮一峰</a></p>
</li>
<li>
<p><a href="http://blog.zhaojie.me/" target="_blank" rel="noopener">赵劼</a></p>
</li>
<li>
<p><a href="http://www.yinwang.org/" target="_blank" rel="noopener">王垠</a></p>
</li>
<li>
<p><a href="https://www.cnblogs.com/CreateMyself/" target="_blank" rel="noopener">Jeffcky</a></p>
</li>
</ul>
<h3 id="书签"><a class="header-anchor" href="#书签">¶</a>书签</h3>
<ul>
<li>
<p><a href="https://xn--gmqz83awjh.com/" target="_blank" rel="noopener">少数人</a>：<a href="https://xn--gmqz83awjh.com/auth/register?code=lu5F" target="_blank" rel="noopener">我的推广链接</a></p>
</li>
<li>
<p><a href="http://tx2play1.douyucdn.cn/live/288016rlols5.flv" target="_blank" rel="noopener">斗鱼直播源——英雄联盟</a></p>
</li>
<li>
<p><a href="http://aria2.github.io/" target="_blank" rel="noopener">Aria2</a></p>
</li>
<li>
<p><a href="http://aria2c.com/" target="_blank" rel="noopener">Aria2 Web 控制台</a></p>
</li>
<li>
<p><a href="http://aria2.me/aria-ng/" target="_blank" rel="noopener">AriaNg</a></p>
</li>
<li>
<p><a href="http://www.gsxt.gov.cn/index.html" target="_blank" rel="noopener">国家企业信用信息公示系统</a></p>
</li>
<li>
<p><a href="https://www.oray.com/" target="_blank" rel="noopener">贝锐科技</a>：花生壳、向日葵、蒲公英</p>
</li>
<li>
<p><a href="https://www.itsk.com/" target="_blank" rel="noopener">IT 天空</a>：万能驱动、优启通</p>
</li>
<li>
<p><a href="https://www.processon.com/" target="_blank" rel="noopener">ProcessOn</a>：免费在线作图</p>
</li>
<li>
<p><a href="https://efotinis.neocities.org/deskpins/" target="_blank" rel="noopener">DeskPins</a>：置顶工具</p>
</li>
<li>
<p><a href="https://whoer.net/zh" target="_blank" rel="noopener">WHOER</a></p>
</li>
<li>
<p><a href="http://www.wepe.com.cn/" target="_blank" rel="noopener">微 PE 工具箱</a></p>
</li>
<li>
<p><a href="https://smallpdf.com/cn" target="_blank" rel="noopener">SmallPDF</a></p>
</li>
<li>
<p><a href="http://www.pdfdo.com/" target="_blank" rel="noopener">PDF 转换器</a></p>
</li>
<li>
<p><a href="https://cowtransfer.com/" target="_blank" rel="noopener">奶牛快传</a>：免登录文件传输</p>
</li>
<li>
<p><a href="https://wetransfer.com/" target="_blank" rel="noopener">WeTransfer</a>：文件传输</p>
</li>
<li>
<p><a href="https://uzer.me/" target="_blank" rel="noopener">UZER.ME</a>：在线体验 PS、Ai、Office 等软件</p>
</li>
<li>
<p><a href="https://www.pexels.com/zh-cn/" target="_blank" rel="noopener">Pexels</a>：免费素材照片</p>
</li>
<li>
<p><a href="http://www.mvcat.com/" target="_blank" rel="noopener">影猫</a>：电影推荐</p>
</li>
<li>
<p><a href="https://naotu.baidu.com/" target="_blank" rel="noopener">百度脑图</a>：思维导图</p>
</li>
</ul>
<h3 id="后记"><a class="header-anchor" href="#后记">¶</a>后记</h3>
<p>😋 啥时候我也能提供免费的服务呢？</p>
]]></content>
      <categories>
        <category>记录</category>
      </categories>
  </entry>
  <entry>
    <title>Hexo搭建静态博客</title>
    <url>/2018/03/04/Hexo%E6%90%AD%E5%BB%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/</url>
    <content><![CDATA[<h3 id="前言"><a class="header-anchor" href="#前言">¶</a>前言</h3>
<p>自从看了阮一峰老师搭建博客的<a href="http://www.ruanyifeng.com/blog/2012/08/blogging_with_jekyll.html" target="_blank" rel="noopener">文章</a>，便萌生了白嫖的想法。Github Pages 提供了静态页面展示功能，用来搭建博客再合适不过，尽管 Github 日常被墙。了解到 Jekyll 需要安装 Ruby，而 Hexo 是用 Nodejs，目前我对 Nodejs 比较感兴趣，所以就决定使用<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>，感谢 visugar 的<a href="http://visugar.com/2017/05/04/20170504SetUpHexoBlog/" target="_blank" rel="noopener">Hexo 教程</a>，我参照此教程搭建了本博客，主题使用的是<a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a>，目前已改用<a href="https://theme-next.org/docs/" target="_blank" rel="noopener">NexT</a>，第一篇文章就简单记录一下使用 Hexo 来搭建博客的步骤。</p>
<h3 id="资源链接"><a class="header-anchor" href="#资源链接">¶</a>资源链接</h3>
<ol>
<li><a href="http://www.ruanyifeng.com/blog/2012/08/blogging_with_jekyll.html" target="_blank" rel="noopener">搭建一个免费的，无限流量的 Blog----github Pages 和 Jekyll 入门</a></li>
<li><a href="http://visugar.com/2017/05/04/20170504SetUpHexoBlog/" target="_blank" rel="noopener">搭建 Hexo 博客</a></li>
<li><a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a></li>
<li><a href="https://blog.zhangruipeng.me/hexo-theme-icarus/" target="_blank" rel="noopener">Icarus</a></li>
<li><a href="https://theme-next.org/docs/" target="_blank" rel="noopener">NexT</a></li>
</ol>
<a id="more"></a>
<h3 id="安装前提"><a class="header-anchor" href="#安装前提">¶</a>安装前提</h3>
<ul>
<li>
<p>安装<a href="http://nodejs.org/" target="_blank" rel="noopener">Node.js</a>，建议安装 LTS（长期支持）版本，在安装过程中记得勾选<a href="https://docs.npmjs.com/about-npm/" target="_blank" rel="noopener">npm</a>包管理工具。</p>
<p>安装好之后，在 CMD 或 Powershell 中输入以下命令进行验证，报错请自行百度。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> node -v</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm -v</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><a href="http://git-scm.com/" target="_blank" rel="noopener">Git</a></p>
<p>安装好之后，在 cmd 中输入以下命令进行验证。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git --version</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="安装-Hexo"><a class="header-anchor" href="#安装-Hexo">¶</a>安装 Hexo</h3>
<p>安装 Hexo，-g 参数表示全局安装。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm install -g hexo-cli</span></span><br></pre></td></tr></table></figure>
<h3 id="建站"><a class="header-anchor" href="#建站">¶</a>建站</h3>
<p>安装 Hexo 完成后，请执行下列命令，Hexo 将会在指定文件夹中新建所需要的文件。如果没有设置 <code>folder</code> ，Hexo 默认在目前的文件夹建立网站。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> hexo init &lt;folder&gt;</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> &lt;folder&gt;</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install</span></span><br></pre></td></tr></table></figure>
<p>Hexo 和主题 NexT 的部分按照官方文档一步步来即可。</p>
<h3 id="Github-配置"><a class="header-anchor" href="#Github-配置">¶</a>Github 配置</h3>
<p>步骤如下所示，详情参见<a href="https://pages.github.com/" target="_blank" rel="noopener">Github Pages</a></p>
<ol>
<li>
<p>在 Github](<a href="https://github.com" target="_blank" rel="noopener">https://github.com</a>)上注册一个账户</p>
</li>
<li>
<p>创建一个名称为<em>username</em> .github.io 的仓库，其中<em>username</em> 为你的用户名</p>
</li>
<li>
<p>目前 Github pages 要求个人项目必须部署在 master 分支，所以用第三方 CI 部署在 gh-pages 是不行的，需要修改 CI 配置</p>
</li>
<li>
<p>如果已有 SSH 公钥放入 Github 中，可跳至第 6 步；在 Git bash 中配置用户名和邮件地址</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git config --global user.name <span class="string">"username"</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config --global user.email <span class="string">"mail@example.com"</span></span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>创建 SSH</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ssh-keygen -t rsa -C <span class="string">"mail@example.com"</span></span></span><br></pre></td></tr></table></figure>
<p>在<code>C:\Users\&quot;username&quot;\.ssh</code>中打开 id_rsa.pub，将其添加到 github 的 SSH Keys 中</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ssh -T git@github.com</span></span><br></pre></td></tr></table></figure>
<p>验证是否成功</p>
</li>
<li>
<p>打开 Hexo 建站的文件夹，修改<code>_config.yml</code>文件的配置，<code>&quot;username&quot;</code>替换为你的 GitHub 用户名</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:"username"/"username".github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="启动服务"><a class="header-anchor" href="#启动服务">¶</a>启动服务</h3>
<p>在 Hexo 建站的文件夹中启动 git bash，分别执行</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> hexo server</span></span><br></pre></td></tr></table></figure>
<p>打开浏览器，访问 <code>http://localhost:4000/</code>即可访问博客。</p>
<h3 id="部署"><a class="header-anchor" href="#部署">¶</a>部署</h3>
<p>执行一次命令，安装部署工具</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>
<p>之后部署到 github，只需要执行</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> hexo g -d</span></span><br></pre></td></tr></table></figure>
<p>部署完成后，访问<code>https://&quot;username&quot;.github.io/</code>即可。</p>
<h3 id="VSCode编辑体验"><a class="header-anchor" href="#VSCode编辑体验">¶</a>VSCode编辑体验</h3>
<p>在 Hexo 3.0 及以上的版本中可以在_config.yml中设置<a href="https://hexo.io/zh-cn/docs/asset-folders" target="_blank" rel="noopener">资源文件夹</a></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>这样就可以通过这种方式引用图片到Markdown中</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% asset_img xxx %&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Paste-Image插件"><a class="header-anchor" href="#Paste-Image插件">¶</a><a href="https://marketplace.visualstudio.com/items?itemName=mushan.vscode-paste-image" target="_blank" rel="noopener">Paste Image</a>插件</h4>
<p>安装插件，修改一下设置，这样，复制好的图片，直接用 <code>Ctrl+Alt+V</code> 键粘贴图片到Markdown中</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">"pasteImage.path": "$&#123;currentFileNameWithoutExt&#125;/",</span><br><span class="line">"pasteImage.insertPattern": "&#123;% asset_img $&#123;imageFileName&#125; %&#125;"</span><br></pre></td></tr></table></figure>
<h4 id="Markdown-Preview-Enhanced"><a class="header-anchor" href="#Markdown-Preview-Enhanced">¶</a><a href="https://marketplace.visualstudio.com/items?itemName=shd101wyy.markdown-preview-enhanced" target="_blank" rel="noopener">Markdown Preview Enhanced</a></h4>
<p>未测试，可能会有问题</p>
<p>安装插件，按 <code>Ctrl+Shift+P</code> 找到 <code>Markdown Preview Enhanced: Extend Parser</code>，打开<code>parser.js</code>，修改<code>onWillParseMarkdown</code>方法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">onWillParseMarkdown: <span class="function"><span class="keyword">function</span>(<span class="params">markdown</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span> &#123;</span><br><span class="line">    markdown = markdown.replace(</span><br><span class="line">      /&#123;%s*asset_imgs*(.*)s*%&#125;/g,</span><br><span class="line">      (whole, content) =&gt; (<span class="string">`![](<span class="subst">$&#123;content&#125;</span>)`</span>)</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> resolve(markdown)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h3 id="Github-Actions"><a class="header-anchor" href="#Github-Actions">¶</a>Github Actions</h3>
<p>增加一个文件 <code>\.github\workflows\ci.yml</code></p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">ci</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> <span class="string">[</span> <span class="string">source</span> <span class="string">]</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build-and-deploy:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">actions/checkout@master</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">and</span> <span class="string">Deploy</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">JamesIves/github-pages-deploy-action@master</span></span><br><span class="line">      <span class="attr">env:</span></span><br><span class="line">        <span class="attr">ACCESS_TOKEN:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.ACCESS_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">        <span class="attr">BASE_BRANCH:</span> <span class="string">source</span></span><br><span class="line">        <span class="attr">BRANCH:</span> <span class="string">master</span></span><br><span class="line">        <span class="attr">FOLDER:</span> <span class="string">public</span></span><br><span class="line">        <span class="attr">BUILD_SCRIPT:</span> <span class="string">npm</span> <span class="string">i</span> <span class="string">-g</span> <span class="string">hexo</span> <span class="string">&amp;&amp;</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">&amp;&amp;</span> <span class="string">hexo</span> <span class="string">generate</span></span><br></pre></td></tr></table></figure>
<p>同时将Hexo文件夹本身Push到source分支，即可自动构建到master分支，部署博客。</p>
<hr>
<h3 id="后记"><a class="header-anchor" href="#后记">¶</a>后记</h3>
<p>😂 话说朋友圈都不看的人，还写什么博客。</p>
]]></content>
      <categories>
        <category>教程</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>博客</tag>
      </tags>
  </entry>
</search>
